[{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\AppointmentEditModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\AppointmentWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BottomMobileNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BrandIdentitySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BrutalBackground.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BrutalButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BrutalCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BusinessGalleryManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\BusinessHoursEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\CalendarPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ClientAuthModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\CommissionPaymentHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\CommissionsManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\DynamicBranding.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\GoalHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\Header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\HelpButtons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\MonthYearSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\MonthlyHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\MoreOptionsDrawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\OnboardingLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\PaywallModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\PhoneInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ProfessionalCommissionDetails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ProfessionalSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ProfileModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\PublicLinkCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\QuickActionsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\SaveFooter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\Screw.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\SearchableSelect.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\ServiceModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\SettingsLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\TeamMemberCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\TeamMemberForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\TimeGrid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\TrialBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\UpsellSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\AppointmentReview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\CategoryFilter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\ClientSelection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\ScheduleSelection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\ServiceList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\ServiceSearchBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\appointment\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\dashboard\\ActionCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\dashboard\\ProfitMetrics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\onboarding\\StepBusinessHours.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":40,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":40,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1248,1301],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":54,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":54,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1812,1861],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { BusinessHoursEditor } from '../BusinessHoursEditor';\r\n\r\ninterface StepBusinessHoursProps {\r\n    onNext: () => void;\r\n    onBack: () => void;\r\n    accentColor: string;\r\n}\r\n\r\n// Novo padr√£o de hor√°rio: 09:00-21:00 com almo√ßo 12:30-13:30\r\nconst defaultHours = {\r\n    isOpen: true,\r\n    blocks: [\r\n        { start: '09:00', end: '12:30' },\r\n        { start: '13:30', end: '21:00' }\r\n    ]\r\n};\r\n\r\nexport const StepBusinessHours: React.FC<StepBusinessHoursProps> = ({ onNext, onBack, accentColor }) => {\r\n    const { user, userType } = useAuth();\r\n    const [loading, setLoading] = useState(false);\r\n    const [businessHours, setBusinessHours] = useState<any>({\r\n        mon: defaultHours,\r\n        tue: defaultHours,\r\n        wed: defaultHours,\r\n        thu: defaultHours,\r\n        fri: defaultHours,\r\n        sat: { isOpen: true, blocks: [{ start: '09:00', end: '14:00' }] },\r\n        sun: { isOpen: false, blocks: [] },\r\n    });\r\n\r\n    const handleSubmit = async () => {\r\n        if (!user) return;\r\n        setLoading(true);\r\n\r\n        try {\r\n            console.log('Saving business hours:', businessHours);\r\n\r\n            const { error: settingsError } = await supabase.from('business_settings').upsert({\r\n                user_id: user.id,\r\n                business_hours: businessHours\r\n            }, { onConflict: 'user_id' });\r\n\r\n            if (settingsError) {\r\n                console.error('Error saving business hours:', settingsError);\r\n                alert('Erro ao salvar hor√°rios. Por favor, tente novamente.');\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            console.log('Business hours saved successfully');\r\n\r\n            const { error: stepError } = await supabase.rpc('update_onboarding_step', {\r\n                p_user_id: user.id,\r\n                p_step: 3\r\n            });\r\n\r\n            if (stepError) {\r\n                console.error('Error updating onboarding step:', stepError);\r\n            }\r\n\r\n            onNext();\r\n        } catch (error) {\r\n            console.error('Error saving hours:', error);\r\n            alert('Erro ao salvar hor√°rios. Por favor, tente novamente.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <BusinessHoursEditor\r\n                hours={businessHours}\r\n                onChange={setBusinessHours}\r\n                isBeauty={userType === 'beauty'}\r\n            />\r\n\r\n            <div className=\"flex gap-4 pt-4\">\r\n                <button\r\n                    onClick={onBack}\r\n                    className=\"flex-1 py-4 bg-neutral-800 text-white font-bold rounded-lg hover:bg-neutral-700 transition-colors\"\r\n                >\r\n                    Voltar\r\n                </button>\r\n                <button\r\n                    onClick={handleSubmit}\r\n                    disabled={loading}\r\n                    className={accentColor === 'beauty-neon' ? 'flex-1 py-4 bg-beauty-neon text-black font-bold rounded-lg hover:bg-beauty-neon/90 transition-colors flex items-center justify-center gap-2' : 'flex-1 py-4 bg-accent-gold text-black font-bold rounded-lg hover:bg-accent-gold/90 transition-colors flex items-center justify-center gap-2'}\r\n                >\r\n                    {loading ? <Loader2 className=\"w-6 h-6 animate-spin\" /> : 'Continuar'}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\onboarding\\StepBusinessInfo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\onboarding\\StepServices.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\onboarding\\StepSuccess.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\onboarding\\StepTeam.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\components\\security\\TwoFactorSetup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\constants\\i18n-glossary.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\contexts\\AlertsContext.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":215,"column":45,"nodeType":"MemberExpression","messageId":"unexpected","endLine":215,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\nimport { useAuth } from './AuthContext';\r\n\r\nexport interface Alert {\r\n    id: string;\r\n    text: string;\r\n    type: 'warning' | 'danger' | 'success';\r\n    actionPath?: string;\r\n}\r\n\r\ninterface AlertsContextType {\r\n    alerts: Alert[];\r\n    loading: boolean;\r\n    refreshAlerts: () => Promise<void>;\r\n}\r\n\r\nconst AlertsContext = createContext<AlertsContextType | undefined>(undefined);\r\n\r\nexport const AlertsProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\r\n    const { user } = useAuth();\r\n    const [alerts, setAlerts] = useState<Alert[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const generateSmartAlerts = async (createdAt: Date | null) => {\r\n        if (!user) return [];\r\n        const generatedAlerts: Alert[] = [];\r\n\r\n        try {\r\n            // --- ALERTA: Agendamentos Atrasados ---\r\n            const now = new Date().toISOString();\r\n            const { data: overdueApts } = await supabase\r\n                .from('appointments')\r\n                .select('id')\r\n                .eq('user_id', user.id)\r\n                .in('status', ['Confirmed', 'Pending'])\r\n                .lt('appointment_time', now);\r\n\r\n            if (overdueApts && overdueApts.length > 0) {\r\n                generatedAlerts.push({\r\n                    id: 'overdue-appointments',\r\n                    text: `‚ö†Ô∏è ${overdueApts.length} agendamento(s) pendente(s) de conclus√£o/cancelamento.`,\r\n                    type: 'danger',\r\n                    actionPath: '/agenda?filter=overdue'\r\n                });\r\n            }\r\n\r\n            // --- ALERTA: Novos Agendamentos Online ---\r\n            const { data: pendingBookings } = await supabase\r\n                .from('public_bookings')\r\n                .select('id')\r\n                .eq('business_id', user.id)\r\n                .eq('status', 'pending');\r\n\r\n            if (pendingBookings && pendingBookings.length > 0) {\r\n                generatedAlerts.push({\r\n                    id: 'pending-public-bookings',\r\n                    text: `üìå Voc√™ tem ${pendingBookings.length} agendamento(s) online aguardando aprova√ß√£o.`,\r\n                    type: 'warning',\r\n                    actionPath: '/agenda'\r\n                });\r\n            }\r\n\r\n            // --- ALERTA: Acerto de Comiss√µes ---\r\n            const { data: settings } = await supabase\r\n                .from('business_settings')\r\n                .select('commission_settlement_day_of_month, onboarding_completed')\r\n                .eq('user_id', user.id)\r\n                .single();\r\n\r\n            const onboardingCompleted = settings?.onboarding_completed ?? false;\r\n\r\n            if (settings?.commission_settlement_day_of_month) {\r\n                const settlementDay = settings.commission_settlement_day_of_month;\r\n                const today = new Date();\r\n                const currentDay = today.getDate();\r\n\r\n                // Calculate days remaining until the settlement day\r\n                let daysRemaining = settlementDay - currentDay;\r\n\r\n                // If the settlement day has passed this month, calculate for next month\r\n                if (daysRemaining < 0) {\r\n                    const nextMonth = new Date(today.getFullYear(), today.getMonth() + 1, settlementDay);\r\n                    daysRemaining = Math.ceil((nextMonth.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));\r\n                }\r\n\r\n                // Check if there are commissions due\r\n                const { data: commissionsDue } = await supabase.rpc('get_commissions_due', { p_user_id: user.id });\r\n                const totalDue = (commissionsDue || []).reduce((sum: number, r: any) => sum + (r.total_due || 0), 0);\r\n\r\n                if (totalDue > 0) {\r\n                    if (daysRemaining <= 2 && daysRemaining > 0) {\r\n                        generatedAlerts.push({\r\n                            id: 'commission-settlement-warning',\r\n                            text: `‚ö†Ô∏è Acerto de comiss√µes se aproxima! Dia ${settlementDay} ser√° o dia do acerto de comiss√µes.`,\r\n                            type: 'warning',\r\n                            actionPath: '/financeiro?tab=commissions'\r\n                        });\r\n                    } else if (daysRemaining === 0) {\r\n                        generatedAlerts.push({\r\n                            id: 'commission-settlement-today',\r\n                            text: `üí∞ Hoje √© dia de acerto de comiss√µes! Total pendente: R$ ${totalDue.toFixed(2)}`,\r\n                            type: 'danger',\r\n                            actionPath: '/financeiro?tab=commissions'\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            // --- ALERTA DE SETUP (L√≥gica de conta nova) ---\r\n            const isNewAccount = createdAt &&\r\n                (new Date().getTime() - createdAt.getTime()) < (7 * 24 * 60 * 60 * 1000);\r\n\r\n            if (isNewAccount) {\r\n                // Fetch basic status in parallel\r\n                const [\r\n                    { count: servicesCount, error: servicesError },\r\n                    { count: teamCount, error: teamError },\r\n                    { data: profile, error: profileError }\r\n                ] = await Promise.all([\r\n                    supabase.from('services').select('id', { count: 'exact', head: true }).eq('user_id', user.id),\r\n                    supabase.from('team_members').select('id', { count: 'exact', head: true }).eq('user_id', user.id),\r\n                    supabase.from('profiles').select('business_name, logo_url').eq('id', user.id).maybeSingle()\r\n                ]);\r\n\r\n                // 1. Services Check\r\n                if (!servicesError && (servicesCount === 0 || servicesCount === null) && !onboardingCompleted) {\r\n                    generatedAlerts.push({\r\n                        id: 'setup-services',\r\n                        text: 'üìã Configure seus servi√ßos e pre√ßos para come√ßar',\r\n                        type: 'warning',\r\n                        actionPath: '/configuracoes/servicos'\r\n                    });\r\n                }\r\n\r\n                // 2. Team Check\r\n                if (!teamError && (teamCount === 0 || teamCount === null) && !onboardingCompleted) {\r\n                    generatedAlerts.push({\r\n                        id: 'setup-team',\r\n                        text: 'üë• Adicione membros da equipe para gerenciar agendamentos',\r\n                        type: 'warning',\r\n                        actionPath: '/configuracoes/equipe'\r\n                    });\r\n                }\r\n\r\n                // 3. Profile/Business Check\r\n                if (!profileError && profile) {\r\n                    if (!profile.business_name && !onboardingCompleted) {\r\n                        generatedAlerts.push({\r\n                            id: 'setup-profile',\r\n                            text: 'üë§ Configure seu perfil',\r\n                            type: 'warning',\r\n                            actionPath: '/configuracoes/geral'\r\n                        });\r\n                    }\r\n\r\n                    if (!profile.logo_url) {\r\n                        generatedAlerts.push({\r\n                            id: 'setup-business',\r\n                            text: 'üè™ Adicione foto e capa do seu estabelecimento',\r\n                            type: 'warning',\r\n                            actionPath: '/configuracoes/geral'\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error generating alerts:', error);\r\n        }\r\n\r\n        return generatedAlerts;\r\n    };\r\n\r\n    const refreshAlerts = async () => {\r\n        if (!user) {\r\n            setAlerts([]);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            let userCreatedAt: Date | null = null;\r\n            if (user.created_at) {\r\n                userCreatedAt = new Date(user.created_at);\r\n            }\r\n\r\n            const newAlerts = await generateSmartAlerts(userCreatedAt);\r\n            setAlerts(newAlerts);\r\n        } catch (error) {\r\n            console.error('Error refreshing alerts:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        refreshAlerts();\r\n\r\n        // 1. Refresh alerts every 5 minutes\r\n        const interval = setInterval(refreshAlerts, 5 * 60 * 1000);\r\n\r\n        // 2. Real-time subscription for public_bookings to alert immediately\r\n        const subscription = supabase\r\n            .channel('public_bookings_alerts')\r\n            .on('postgres_changes', {\r\n                event: 'INSERT',\r\n                schema: 'public',\r\n                table: 'public_bookings',\r\n                filter: `business_id=eq.${user?.id}`\r\n            }, (payload) => {\r\n                // Play notification sound\r\n                try {\r\n                    const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3'); // Gentle notification sound\r\n                    audio.play().catch(e => console.log('Audio play failed (interaction needed?):', e));\r\n                } catch (e) {\r\n                    console.error('Error playing sound:', e);\r\n                }\r\n\r\n                refreshAlerts();\r\n            })\r\n            .subscribe();\r\n\r\n        // 3. Real-time subscription for status updates\r\n        const updateSubscription = supabase\r\n            .channel('public_bookings_updates')\r\n            .on('postgres_changes', {\r\n                event: 'UPDATE',\r\n                schema: 'public',\r\n                table: 'public_bookings',\r\n                filter: `business_id=eq.${user?.id}`\r\n            }, () => {\r\n                refreshAlerts();\r\n            })\r\n            .subscribe();\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n            supabase.removeChannel(subscription);\r\n            supabase.removeChannel(updateSubscription);\r\n        };\r\n    }, [user]);\r\n\r\n    return (\r\n        <AlertsContext.Provider value={{ alerts, loading, refreshAlerts }}>\r\n            {children}\r\n        </AlertsContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAlerts = () => {\r\n    const context = useContext(AlertsContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAlerts must be used within an AlertsProvider');\r\n    }\r\n    return context;\r\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\contexts\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\contexts\\PublicClientContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\contexts\\UIContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\hooks\\use2FA.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\hooks\\useAppTour.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\hooks\\useDashboardData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\hooks\\useDynamicBranding.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\hooks\\useSubscription.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\lib\\auditLogs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\lib\\gemini.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Agenda.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":655,"column":21,"nodeType":"MemberExpression","messageId":"unexpected","endLine":655,"endColumn":32,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[27492,27557],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\nimport { BrutalCard } from '../components/BrutalCard';\r\nimport { BrutalButton } from '../components/BrutalButton';\r\nimport { Calendar, Clock, Plus, User, Users, Check, X, ChevronLeft, ChevronRight, History, AlertTriangle, Loader2, Trash2, Edit2, Tag, Scissors, MessageCircle, Info, DollarSign } from 'lucide-react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { AppointmentEditModal } from '../components/AppointmentEditModal';\r\nimport { AppointmentWizard } from '../components/AppointmentWizard';\r\n\r\nimport { formatCurrency, formatPhone } from '../utils/formatters';\r\nimport { formatDateForInput } from '../utils/date';\r\nimport { useAppTour } from '../hooks/useAppTour';\r\n\r\ninterface Appointment {\r\n    id: string;\r\n    client_id: string;\r\n    clientName: string;\r\n    service: string;\r\n    appointment_time: string;\r\n    price: number;\r\n    status: string;\r\n    professional_id: string | null;\r\n    basePrice?: number; // Base price for discount calculation\r\n    clientPhone?: string;\r\n}\r\n\r\ninterface TeamMember {\r\n    id: string;\r\n    name: string;\r\n    photo_url?: string;\r\n}\r\n\r\ninterface Service {\r\n    id: string;\r\n    name: string;\r\n    price: number;\r\n    duration_minutes?: number;\r\n    category_id?: string;\r\n    description?: string | null;\r\n}\r\n\r\ninterface Category {\r\n    id: string;\r\n    name: string;\r\n}\r\n\r\ninterface Client {\r\n    id: string;\r\n    name: string;\r\n    phone?: string;\r\n}\r\n\r\n// Helper para obter a data inicial (da URL ou hoje)\r\nconst getInitialDate = (searchParams: URLSearchParams): Date => {\r\n    const dateParam = searchParams.get('date');\r\n    if (dateParam) {\r\n        const date = new Date(dateParam);\r\n        // Verifica se a data √© v√°lida e n√£o √© NaN\r\n        if (!isNaN(date.getTime())) {\r\n            // Ajusta para o fuso hor√°rio local para evitar problemas de dia\r\n            const localDate = new Date(date.getTime() + date.getTimezoneOffset() * 60000);\r\n            return localDate;\r\n        }\r\n    }\r\n    return new Date();\r\n};\r\n\r\nexport const Agenda: React.FC = () => {\r\n    const { user, userType, region } = useAuth();\r\n    const [searchParams] = useSearchParams();\r\n    const navigate = useNavigate();\r\n    useAppTour(); // Instancia para detectar continua√ß√£o do tour\r\n    const [appointments, setAppointments] = useState<Appointment[]>([]);\r\n    const [publicBookings, setPublicBookings] = useState<any[]>([]);\r\n    const [teamMembers, setTeamMembers] = useState<TeamMember[]>([]);\r\n    const [clients, setClients] = useState<Client[]>([]);\r\n    const [services, setServices] = useState<Service[]>([]);\r\n    const [categories, setCategories] = useState<Category[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedDate, setSelectedDate] = useState(getInitialDate(searchParams));\r\n    const [showNewAppointmentModal, setShowNewAppointmentModal] = useState(false);\r\n    const [showHistoryModal, setShowHistoryModal] = useState(false);\r\n    const [historyAppointments, setHistoryAppointments] = useState<Appointment[]>([]);\r\n    const [historyMonth, setHistoryMonth] = useState(new Date());\r\n    const [selectedProfessionalFilter, setSelectedProfessionalFilter] = useState<string | null>(null);\r\n    const [overdueAppointments, setOverdueAppointments] = useState<Appointment[]>([]);\r\n    const [isOverdueLoading, setIsOverdueLoading] = useState(false);\r\n    const [businessName, setBusinessName] = useState(''); // NEW STATE FOR BUSINESS NAME\r\n\r\n    // State for editing\r\n    const [editingAppointment, setEditingAppointment] = useState<Appointment | null>(null);\r\n\r\n    // Form state (for new appointment modal)\r\n    const [selectedClient, setSelectedClient] = useState('');\r\n    const [selectedServices, setSelectedServices] = useState<string[]>([]);\r\n    const [selectedProfessional, setSelectedProfessional] = useState('');\r\n    const [selectedTime, setSelectedTime] = useState('');\r\n    const [customTime, setCustomTime] = useState('');\r\n    const [selectedAppointmentDate, setSelectedAppointmentDate] = useState(formatDateForInput(selectedDate));\r\n    const [discountPercentage, setDiscountPercentage] = useState('0'); // NEW STATE FOR DISCOUNT\r\n    const [notes, setNotes] = useState(''); // NEW STATE FOR NOTES\r\n    const [finalPriceInput, setFinalPriceInput] = useState('');\r\n\r\n\r\n    const isBeauty = userType === 'beauty';\r\n    const accentColor = isBeauty ? 'beauty-neon' : 'accent-gold';\r\n    const accentText = isBeauty ? 'text-beauty-neon' : 'text-accent-gold';\r\n    const accentBg = isBeauty ? 'bg-beauty-neon' : 'bg-accent-gold';\r\n    const currencySymbol = region === 'PT' ? '‚Ç¨' : 'R$';\r\n    const currencyRegion = region === 'PT' ? 'PT' : 'BR';\r\n\r\n    const isOverdueFilter = searchParams.get('filter') === 'overdue';\r\n\r\n    // Atualiza selectedDate se o par√¢metro de URL mudar\r\n    useEffect(() => {\r\n        setSelectedDate(getInitialDate(searchParams));\r\n    }, [searchParams]);\r\n\r\n    useEffect(() => {\r\n        const dateParam = searchParams.get('date');\r\n        if (dateParam) {\r\n            const newDate = new Date(dateParam);\r\n            const userTimezoneOffset = newDate.getTimezoneOffset() * 60000;\r\n            const adjustedDate = new Date(newDate.getTime() + userTimezoneOffset);\r\n            setSelectedDate(adjustedDate);\r\n        }\r\n    }, [searchParams]);\r\n\r\n    // Real-time subscription for public bookings\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        const subscription = supabase\r\n            .channel('public_bookings_agenda')\r\n            .on('postgres_changes', {\r\n                event: '*',\r\n                schema: 'public',\r\n                table: 'public_bookings',\r\n                filter: `business_id=eq.${user.id}`\r\n            }, () => {\r\n                fetchPublicBookings();\r\n            })\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(subscription);\r\n        };\r\n    }, [user]);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            fetchData();\r\n        }\r\n    }, [user, selectedDate]);\r\n\r\n    // State for viewing appointment details\r\n    const [showingDetailsAppointment, setShowingDetailsAppointment] = useState<Appointment | null>(null);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (isOverdueFilter) {\r\n            fetchOverdueAppointments();\r\n        }\r\n    }, [user, isOverdueFilter]);\r\n\r\n    // Effect to fetch history appointments when historyMonth changes and modal is open\r\n    useEffect(() => {\r\n        if (showHistoryModal) {\r\n            fetchHistoryAppointments();\r\n        }\r\n    }, [historyMonth, showHistoryModal]);\r\n\r\n    // Price Calculation & Sync Effect\r\n    const selectedServicesDetails = services.filter(s => selectedServices.includes(s.id));\r\n    const basePriceNew = selectedServicesDetails.reduce((sum, s) => sum + s.price, 0);\r\n    const discountRateNew = parseFloat(discountPercentage) / 100;\r\n    const finalPriceNew = basePriceNew * (1 - (isNaN(discountRateNew) ? 0 : discountRateNew));\r\n\r\n    useEffect(() => {\r\n        setFinalPriceInput(finalPriceNew.toFixed(2));\r\n    }, [basePriceNew, discountPercentage]);\r\n\r\n\r\n\r\n    // Update selectedAppointmentDate when modal opens or selectedDate changes\r\n    useEffect(() => {\r\n        if (showNewAppointmentModal) {\r\n            setSelectedAppointmentDate(formatDateForInput(selectedDate));\r\n\r\n            // Auto-select professional if filter is active or only one exists\r\n            if (selectedProfessionalFilter) {\r\n                setSelectedProfessional(selectedProfessionalFilter);\r\n            } else if (teamMembers.length === 1) {\r\n                setSelectedProfessional(teamMembers[0].id);\r\n            }\r\n        }\r\n    }, [showNewAppointmentModal, selectedDate, selectedProfessionalFilter, teamMembers]);\r\n\r\n    // Handle clientId and service from URL (coming from CRM history)\r\n    useEffect(() => {\r\n        const clientIdParam = searchParams.get('clientId');\r\n        const serviceNameParam = searchParams.get('service');\r\n        const isNewQuery = searchParams.get('new') === 'true';\r\n\r\n        if (isNewQuery) {\r\n            setShowNewAppointmentModal(true);\r\n        } else if (showNewAppointmentModal) {\r\n            // Ensure URL has ?new=true if modal is open via state, so Layout hides nav\r\n            // But be careful not to trigger loop. \r\n            // Better approach: when opening modal via button, use navigate.\r\n        }\r\n\r\n        if (clientIdParam && clients.length > 0) {\r\n            // Pre-select the client\r\n            setSelectedClient(clientIdParam);\r\n\r\n            // Pre-select service if provided\r\n            if (serviceNameParam && services.length > 0) {\r\n                const matchedService = services.find(s => s.name === serviceNameParam);\r\n                if (matchedService) {\r\n                    setSelectedServices([matchedService.id]);\r\n                }\r\n            }\r\n\r\n            // Open the new appointment modal\r\n            setShowNewAppointmentModal(true);\r\n        }\r\n    }, [searchParams, clients, services]);\r\n\r\n    const fetchData = async () => {\r\n        await Promise.all([\r\n            fetchTeamMembers(),\r\n            fetchAppointments(),\r\n            fetchPublicBookings(),\r\n            fetchClients(),\r\n            fetchServices(),\r\n            fetchCategories(),\r\n            fetchBusinessProfile()\r\n        ]);\r\n        setLoading(false);\r\n    };\r\n\r\n    const fetchTeamMembers = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('team_members')\r\n            .select('id, name, photo_url')\r\n            .eq('user_id', user.id)\r\n            .eq('active', true)\r\n            .order('name');\r\n        if (data) setTeamMembers(data);\r\n    };\r\n\r\n    const fetchAppointments = async () => {\r\n        if (!user) return;\r\n        const startOfDay = new Date(selectedDate);\r\n        startOfDay.setHours(0, 0, 0, 0);\r\n        const endOfDay = new Date(selectedDate);\r\n        endOfDay.setHours(23, 59, 59, 999);\r\n        const now = new Date();\r\n\r\n        // 1. Fetch all services to map names to prices later\r\n        const { data: allServices } = await supabase\r\n            .from('services')\r\n            .select('name, price')\r\n            .eq('user_id', user.id);\r\n\r\n        const servicePriceMap = new Map(allServices?.map(s => [s.name, s.price]));\r\n\r\n        // 2. Fetch appointments for the selected day (Confirmed status)\r\n        const { data } = await supabase\r\n            .from('appointments')\r\n            .select('*, clients(name, id, phone)')\r\n            .eq('user_id', user.id)\r\n            .gte('appointment_time', startOfDay.toISOString())\r\n            .lte('appointment_time', endOfDay.toISOString())\r\n            .in('status', ['Confirmed', 'Pending']) // Include pending for the day view\r\n            .order('appointment_time');\r\n\r\n        if (data) {\r\n            setAppointments(data.map((apt: any) => {\r\n                // Use the price from the service table as the base price\r\n                const basePrice = servicePriceMap.get(apt.service) || apt.price;\r\n                return {\r\n                    id: apt.id,\r\n                    client_id: apt.client_id,\r\n                    clientName: apt.clients?.name || 'Cliente Desconhecido',\r\n                    clientPhone: apt.clients?.phone || '',\r\n                    service: apt.service,\r\n                    appointment_time: apt.appointment_time,\r\n                    price: apt.price,\r\n                    status: apt.status,\r\n                    professional_id: apt.professional_id,\r\n                    basePrice: basePrice,\r\n                    notes: apt.notes\r\n                };\r\n            }));\r\n        }\r\n    };\r\n\r\n    const fetchOverdueAppointments = async () => {\r\n        if (!user) return;\r\n        setIsOverdueLoading(true);\r\n        const now = new Date().toISOString();\r\n\r\n        // 1. Fetch all services to map names to prices later\r\n        const { data: allServices } = await supabase\r\n            .from('services')\r\n            .select('name, price')\r\n            .eq('user_id', user.id);\r\n\r\n        const servicePriceMap = new Map(allServices?.map(s => [s.name, s.price]));\r\n\r\n        const { data } = await supabase\r\n            .from('appointments')\r\n            .select('*, clients(name, phone)')\r\n            .eq('user_id', user.id)\r\n            .in('status', ['Confirmed', 'Pending'])\r\n            .lt('appointment_time', now) // Agendamentos no passado\r\n            .order('appointment_time', { ascending: false });\r\n\r\n        if (data) {\r\n            setOverdueAppointments(data.map((apt: any) => {\r\n                const basePrice = servicePriceMap.get(apt.service) || apt.price;\r\n                return {\r\n                    id: apt.id,\r\n                    client_id: apt.client_id,\r\n                    clientName: apt.clients?.name || 'Cliente Desconhecido',\r\n                    clientPhone: apt.clients?.phone || '',\r\n                    service: apt.service,\r\n                    appointment_time: apt.appointment_time,\r\n                    price: apt.price,\r\n                    status: apt.status,\r\n                    professional_id: apt.professional_id,\r\n                    basePrice: basePrice,\r\n                    notes: apt.notes\r\n                };\r\n            }));\r\n        }\r\n        setIsOverdueLoading(false);\r\n    };\r\n\r\n    const fetchPublicBookings = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('public_bookings')\r\n            .select('*')\r\n            .eq('business_id', user.id)\r\n            .eq('status', 'pending')\r\n            .order('appointment_time');\r\n        if (data) setPublicBookings(data);\r\n    };\r\n\r\n    const fetchClients = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('clients')\r\n            .select('id, name, phone') // Adicionando phone para subtext\r\n            .eq('user_id', user.id)\r\n            .order('name');\r\n        if (data) setClients(data as Client[]);\r\n    };\r\n\r\n    const fetchServices = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('services')\r\n            .select('id, name, price, duration_minutes, category_id, description') // Adicionando details para wizard\r\n            .eq('user_id', user.id)\r\n            .eq('active', true)\r\n            .order('name');\r\n        if (data) setServices(data as Service[]);\r\n    };\r\n\r\n    const fetchCategories = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('service_categories')\r\n            .select('id, name')\r\n            .eq('user_id', user.id)\r\n            .order('name');\r\n        if (data) setCategories(data);\r\n    };\r\n\r\n    const fetchBusinessProfile = async () => {\r\n        if (!user) return;\r\n        const { data } = await supabase\r\n            .from('profiles')\r\n            .select('business_name')\r\n            .eq('id', user.id)\r\n            .single();\r\n        if (data) setBusinessName(data.business_name || 'Seu Estabelecimento');\r\n    };\r\n\r\n    const fetchHistoryAppointments = async () => {\r\n        if (!user) return;\r\n        const startOfMonth = new Date(historyMonth.getFullYear(), historyMonth.getMonth(), 1);\r\n        const endOfMonth = new Date(historyMonth.getFullYear(), historyMonth.getMonth() + 1, 0, 23, 59, 59);\r\n\r\n        // 1. Fetch all services to map names to prices later\r\n        const { data: allServices } = await supabase\r\n            .from('services')\r\n            .select('name, price')\r\n            .eq('user_id', user.id);\r\n\r\n        const servicePriceMap = new Map(allServices?.map(s => [s.name, s.price]));\r\n\r\n        const { data } = await supabase\r\n            .from('appointments')\r\n            .select('*, clients(name)')\r\n            .eq('user_id', user.id)\r\n            .gte('appointment_time', startOfMonth.toISOString())\r\n            .lte('appointment_time', endOfMonth.toISOString())\r\n            .in('status', ['Completed', 'Cancelled'])\r\n            .order('appointment_time', { ascending: false });\r\n\r\n        if (data) {\r\n            setHistoryAppointments(data.map((apt: any) => {\r\n                const basePrice = servicePriceMap.get(apt.service) || apt.price;\r\n                return {\r\n                    id: apt.id,\r\n                    client_id: apt.client_id,\r\n                    clientName: apt.clients?.name || 'Cliente Desconhecido',\r\n                    service: apt.service,\r\n                    appointment_time: apt.appointment_time,\r\n                    price: apt.price,\r\n                    status: apt.status,\r\n                    professional_id: apt.professional_id,\r\n                    basePrice: basePrice,\r\n                    notes: apt.notes\r\n                };\r\n            }));\r\n        }\r\n    };\r\n\r\n    const handleDeleteHistoryAppointment = async (appointmentId: string) => {\r\n        if (!confirm('Tem certeza que deseja excluir este agendamento do hist√≥rico? Esta a√ß√£o √© irrevers√≠vel e remover√° tamb√©m o registro financeiro associado.')) return;\r\n\r\n        try {\r\n            // Delete associated finance records first (if any)\r\n            await supabase.from('finance_records').delete().eq('appointment_id', appointmentId);\r\n\r\n            // Then delete the appointment\r\n            await supabase.from('appointments').delete().eq('id', appointmentId).eq('user_id', user.id);\r\n\r\n            alert('Agendamento e registro financeiro exclu√≠dos com sucesso!');\r\n            fetchHistoryAppointments(); // Refresh history\r\n            fetchData(); // Also refresh main agenda data in case it affects counts/stats\r\n        } catch (error) {\r\n            console.error('Error deleting history appointment:', error);\r\n            alert('Erro ao excluir agendamento do hist√≥rico.');\r\n        }\r\n    };\r\n\r\n    const handleAcceptBooking = async (booking: any) => {\r\n        if (!user || isProcessing) return;\r\n        setIsProcessing(true);\r\n\r\n        try {\r\n            let clientId = null;\r\n\r\n            // 1. Check for existing client by phone number\r\n            // Sanitize phone number for search (remove non-digits?) \r\n            // Better to search exactly as stored first, or maybe both formats if possible.\r\n            // We search for both Raw (+55...) and Formatted ((11)...) to catch legacy clients.\r\n            const rawPhone = booking.customer_phone;\r\n            const formattedPhoneBR = formatPhone(rawPhone, 'BR'); // Try BR mask\r\n            const formattedPhonePT = formatPhone(rawPhone, 'PT'); // Try PT mask\r\n\r\n            // Or filter construction: phone.eq.RAW,phone.eq.FORMATTED...\r\n            // Note: supabase .or() syntax expects comma separated filters\r\n            const orFilter = `phone.eq.${rawPhone},phone.eq.${formattedPhoneBR},phone.eq.${formattedPhonePT}`;\r\n\r\n            const { data: existingClient } = await supabase\r\n                .from('clients')\r\n                .select('id, photo_url')\r\n                .eq('user_id', user.id)\r\n                .or(orFilter)\r\n                .maybeSingle();\r\n\r\n            if (existingClient) {\r\n                clientId = existingClient.id;\r\n\r\n                // 2. Update photo if booking has one and client doesn't (or if we want to auto-update)\r\n                // Let's only update if client has no photo, to avoid overwriting a chosen photo.\r\n                // UNLESS the user wants to update it. The request said: \"queria que pelomenos a foto que ele selecionou, se atualizasse na lista de clientes\"\r\n                // So we should try to update it.\r\n                if (booking.customer_photo_url && (!existingClient.photo_url || existingClient.photo_url !== booking.customer_photo_url)) {\r\n                    // We can't access customer_photo_url directly from public_bookings table easily if it wasn't selected in the query?\r\n                    // Wait, public_bookings doesn't have photo_url usually?\r\n                    // Ah, the user said \"a foto que ele selecionou\". \r\n                    // In PublicBooking.tsx, we upload to `client_photos` but do we save it to `public_bookings`?\r\n                    // Looking at PublicBooking.tsx: handleSubmit uploads and calls `register` (context) or saves to public_bookings?\r\n                    // Actually PublicBooking.tsx implementation of handleSubmit does NOT save photo_url to public_bookings table explicitly in the INSERT.\r\n                    // It registers the client in public_clients table via `register`. \r\n\r\n                    // Let's check if we can get the photo from public_clients table for this booking phone?\r\n                    const { data: publicClient } = await supabase\r\n                        .from('public_clients')\r\n                        .select('photo_url')\r\n                        .eq('phone', booking.customer_phone)\r\n                        .eq('business_id', user.id)\r\n                        .order('created_at', { ascending: false })\r\n                        .limit(1)\r\n                        .single();\r\n\r\n                    if (publicClient && publicClient.photo_url) {\r\n                        await supabase\r\n                            .from('clients')\r\n                            .update({ photo_url: publicClient.photo_url })\r\n                            .eq('id', clientId)\r\n                            .eq('user_id', user.id);\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                // 3. Create new client if not found\r\n                // First try to get photo from public_clients (where it might have been saved during public flow)\r\n                const { data: publicClient } = await supabase\r\n                    .from('public_clients')\r\n                    .select('photo_url')\r\n                    .eq('phone', booking.customer_phone)\r\n                    .eq('business_id', user.id)\r\n                    .order('created_at', { ascending: false })\r\n                    .limit(1)\r\n                    .maybeSingle();\r\n\r\n                const { data: newClient, error: clientError } = await supabase\r\n                    .from('clients')\r\n                    .insert({\r\n                        user_id: user.id,\r\n                        name: booking.customer_name,\r\n                        phone: booking.customer_phone,\r\n                        email: booking.customer_email,\r\n                        photo_url: publicClient?.photo_url || null\r\n                    })\r\n                    .select()\r\n                    .single();\r\n\r\n                if (clientError) throw clientError;\r\n                clientId = newClient.id;\r\n            }\r\n\r\n            // Fetch service names based on IDs\r\n            const { data: serviceDetails } = await supabase\r\n                .from('services')\r\n                .select('name')\r\n                .in('id', booking.service_ids)\r\n                .eq('user_id', user.id);\r\n\r\n            const serviceNames = (serviceDetails || []).map(s => s.name).join(', ');\r\n\r\n            // Auto-assign professional if not specified (e.g., \"Anyone\" booking)\r\n            let finalProfessionalId = booking.professional_id;\r\n            if (!finalProfessionalId) {\r\n                if (teamMembers.length === 1) {\r\n                    finalProfessionalId = teamMembers[0].id;\r\n                } else if (teamMembers.length > 1) {\r\n                    // Try to find the owner or just assign to first available as a fallback\r\n                    // for \"Anyone\" bookings in multi-pro shops, we could leave it\r\n                    // but for this user (1 pro), we definitely want to assignment.\r\n                    finalProfessionalId = teamMembers[0].id;\r\n                }\r\n            }\r\n\r\n            const { error: aptError } = await supabase\r\n                .from('appointments')\r\n                .insert({\r\n                    user_id: user.id,\r\n                    client_id: clientId,\r\n                    professional_id: finalProfessionalId,\r\n                    service: serviceNames,\r\n                    appointment_time: booking.appointment_time,\r\n                    price: booking.total_price,\r\n                    status: 'Confirmed',\r\n                    duration_minutes: booking.duration_minutes || 30\r\n                });\r\n\r\n            if (aptError) throw aptError;\r\n\r\n            await supabase\r\n                .from('public_bookings')\r\n                .update({ status: 'confirmed' })\r\n                .eq('id', booking.id)\r\n                .eq('business_id', user.id);\r\n\r\n            // Fetch the client to ensure we have the correct phone number if it was just created\r\n            const phone = booking.customer_phone;\r\n            const waPhone = phone.replace(/\\D/g, '');\r\n            const waMessage = encodeURIComponent('Seu agendamento foi confirmado');\r\n\r\n            if (window.confirm('Agendamento aceito com sucesso! Deseja enviar uma mensagem de confirma√ß√£o para o cliente via WhatsApp?')) {\r\n                const dateObj = new Date(booking.appointment_time);\r\n                const formattedDate = dateObj.toLocaleDateString('pt-BR');\r\n                const formattedTime = dateObj.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\r\n                const establishment = businessName;\r\n\r\n                const currencySymbol = currencyRegion === 'PT' ? '‚Ç¨' : 'R$';\r\n                const formattedPrice = booking.total_price.toFixed(2).replace('.', ',');\r\n\r\n                const message = `Agendamento confirmado! ‚ú®\r\nüìÖ Data: ${formattedDate}\r\n‚è∞ Hor√°rio: ${formattedTime}\r\nüíá‚Äç‚ôÄÔ∏è Servi√ßo: ${serviceNames}\r\nüí∞ Valor: ${currencySymbol} ${formattedPrice}\r\n\r\nObrigada pela confian√ßa! Te espero no ${establishment}.`;\r\n\r\n                const waMessage = encodeURIComponent(message);\r\n                window.open(`https://wa.me/${waPhone}?text=${waMessage}`, '_blank');\r\n            }\r\n\r\n            fetchData();\r\n        } catch (error) {\r\n            console.error('Error accepting booking:', error);\r\n            alert('Erro ao aceitar agendamento.');\r\n        } finally {\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    const handleRejectBooking = async (bookingId: string) => {\r\n        try {\r\n            await supabase\r\n                .from('public_bookings')\r\n                .update({ status: 'cancelled' })\r\n                .eq('id', bookingId)\r\n                .eq('business_id', user.id);\r\n            alert('Solicita√ß√£o recusada.');\r\n            fetchData();\r\n        } catch (error) {\r\n            console.error('Error rejecting booking:', error);\r\n        }\r\n    };\r\n\r\n    const handleCompleteAppointment = async (appointmentId: string, isOverdue: boolean = false) => {\r\n        try {\r\n            // Use RPC to handle finance record creation\r\n            const { error } = await supabase.rpc('complete_appointment', { p_appointment_id: appointmentId });\r\n\r\n            if (error) throw error;\r\n\r\n            if (isOverdue) {\r\n                fetchOverdueAppointments();\r\n            } else {\r\n                fetchData();\r\n            }\r\n        } catch (error: any) {\r\n            console.error('Error completing appointment:', error);\r\n\r\n            // Fallback for missing updated_at column or other RPC errors\r\n            if (error.message?.includes('updated_at') || error.message?.includes('does not exist')) {\r\n                try {\r\n                    console.log('Attempting client-side fallback for completion...');\r\n\r\n                    // 1. Get appointment details\r\n                    const { data: appointment, error: fetchError } = await supabase\r\n                        .from('appointments')\r\n                        .select('*')\r\n                        .eq('id', appointmentId)\r\n                        .single();\r\n\r\n                    if (fetchError) throw fetchError;\r\n\r\n                    // 2. Update appointment status (without updated_at)\r\n                    const { error: updateError } = await supabase\r\n                        .from('appointments')\r\n                        .update({ status: 'Completed' })\r\n                        .eq('id', appointmentId);\r\n\r\n                    if (updateError) throw updateError;\r\n\r\n                    // 3. Get professional details\r\n                    let commissionRate = 0;\r\n                    let professionalName = 'Profissional';\r\n\r\n                    if (appointment.professional_id) {\r\n                        const { data: professional } = await supabase\r\n                            .from('team_members')\r\n                            .select('name, commission_rate')\r\n                            .eq('id', appointment.professional_id)\r\n                            .single();\r\n\r\n                        if (professional) {\r\n                            professionalName = professional.name;\r\n                            commissionRate = professional.commission_rate || 0;\r\n                        }\r\n                    }\r\n\r\n                    // 4. Calculate commission\r\n                    const commissionValue = (appointment.price * commissionRate) / 100;\r\n\r\n                    // 5. Create finance record\r\n                    const { error: financeError } = await supabase\r\n                        .from('finance_records')\r\n                        .insert({\r\n                            user_id: appointment.user_id,\r\n                            barber_name: professionalName,\r\n                            professional_id: appointment.professional_id,\r\n                            appointment_id: appointmentId,\r\n                            revenue: appointment.price,\r\n                            commission_rate: commissionRate,\r\n                            commission_value: commissionValue,\r\n                            created_at: new Date().toISOString()\r\n                        });\r\n\r\n                    if (financeError) throw financeError;\r\n\r\n                    // Success! Refresh data\r\n                    if (isOverdue) {\r\n                        fetchOverdueAppointments();\r\n                    } else {\r\n                        fetchData();\r\n                    }\r\n                    return; // Exit successfully\r\n\r\n                } catch (fallbackError: any) {\r\n                    console.error('Fallback failed:', fallbackError);\r\n                    alert(`Erro ao concluir agendamento (Fallback falhou): ${fallbackError.message || fallbackError}`);\r\n                }\r\n            } else {\r\n                alert(`Erro ao concluir agendamento: ${error.message || error}`);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleCancelAppointment = async (appointmentId: string, isOverdue: boolean = false) => {\r\n        if (!confirm('Cancelar este agendamento? Ele ser√° movido para o hist√≥rico.')) return;\r\n        try {\r\n            await supabase\r\n                .from('appointments')\r\n                .update({ status: 'Cancelled' })\r\n                .eq('id', appointmentId);\r\n            alert('Agendamento cancelado e movido para o hist√≥rico!');\r\n            if (isOverdue) {\r\n                fetchOverdueAppointments();\r\n            } else {\r\n                fetchData();\r\n            }\r\n        } catch (error) {\r\n            console.error('Error cancelling appointment:', error);\r\n            alert('Erro ao cancelar agendamento.');\r\n        }\r\n    };\r\n\r\n    const handleAssignToProfessional = async (appointmentId: string, professionalId: string) => {\r\n        try {\r\n            const { error } = await supabase\r\n                .from('appointments')\r\n                .update({ professional_id: professionalId })\r\n                .eq('id', appointmentId);\r\n            if (error) throw error;\r\n            fetchData();\r\n        } catch (error) {\r\n            console.error('Error assigning professional:', error);\r\n            alert('Erro ao atribuir profissional.');\r\n        }\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setSelectedClient('');\r\n        setSelectedServices([]);\r\n        setSelectedProfessional('');\r\n        setSelectedTime('');\r\n        setCustomTime('');\r\n        setSelectedAppointmentDate(formatDateForInput(selectedDate));\r\n        setDiscountPercentage('0'); // Reset discount\r\n        setNotes('');\r\n        setFinalPriceInput('');\r\n    };\r\n\r\n\r\n    const handleCreateAppointment = async () => {\r\n        if (!user || !selectedClient || selectedServices.length === 0 || !selectedProfessional || !selectedTime || !selectedAppointmentDate) {\r\n            alert('Preencha todos os campos!');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const selectedServicesDetails = services.filter(s => selectedServices.includes(s.id));\r\n            if (selectedServicesDetails.length === 0) {\r\n                alert('Servi√ßo inv√°lido.');\r\n                return;\r\n            }\r\n\r\n            const basePrice = selectedServicesDetails.reduce((sum, s) => sum + s.price, 0);\r\n\r\n            // Use manually edited price\r\n            const finalPrice = parseFloat(finalPriceInput);\r\n            if (isNaN(finalPrice)) {\r\n                alert('Pre√ßo inv√°lido!');\r\n                return;\r\n            }\r\n\r\n            const serviceNames = selectedServicesDetails.map(s => s.name).join(', ');\r\n\r\n            const dateTime = new Date(selectedAppointmentDate);\r\n            const timeToUse = selectedTime === 'custom' ? customTime : selectedTime;\r\n            const [hours, minutes] = timeToUse.split(':');\r\n            dateTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);\r\n\r\n            const { error } = await supabase\r\n                .from('appointments')\r\n                .insert({\r\n                    user_id: user.id,\r\n                    client_id: selectedClient,\r\n                    professional_id: selectedProfessional,\r\n                    service: serviceNames,\r\n                    appointment_time: dateTime.toISOString(),\r\n                    price: finalPrice, // Use final price after discount\r\n                    status: 'Confirmed',\r\n                    notes: notes\r\n                });\r\n\r\n            if (error) throw error;\r\n\r\n            // Prompt for WhatsApp confirmation\r\n            const client = clients.find(c => c.id === selectedClient);\r\n            if (client?.phone) {\r\n                const waPhone = client.phone.replace(/\\D/g, '');\r\n                const waMessage = encodeURIComponent('Seu agendamento foi confirmado');\r\n\r\n                if (window.confirm('Agendamento criado com sucesso! Deseja enviar uma mensagem de confirma√ß√£o para o cliente via WhatsApp?')) {\r\n                    const dateObj = dateTime;\r\n                    const formattedDate = dateObj.toLocaleDateString('pt-BR');\r\n                    const formattedTime = dateObj.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\r\n                    const establishment = businessName;\r\n\r\n                    const currencySymbol = currencyRegion === 'PT' ? '‚Ç¨' : 'R$';\r\n                    const formattedPrice = finalPrice.toFixed(2).replace('.', ',');\r\n\r\n                    const message = `Agendamento confirmado! ‚ú®\r\nüìÖ Data: ${formattedDate}\r\n‚è∞ Hor√°rio: ${formattedTime}\r\nüíá‚Äç‚ôÄÔ∏è Servi√ßo: ${serviceNames}\r\nüí∞ Valor: ${currencySymbol} ${formattedPrice}\r\n\r\nObrigada pela confian√ßa! Te espero no ${establishment}.`;\r\n\r\n                    const waMessage = encodeURIComponent(message);\r\n                    window.open(`https://wa.me/${waPhone}?text=${waMessage}`, '_blank');\r\n                }\r\n            } else {\r\n                alert('Agendamento criado com sucesso!');\r\n            }\r\n\r\n            setShowNewAppointmentModal(false);\r\n            const newDate = new Date(selectedAppointmentDate);\r\n            const userTimezoneOffset = newDate.getTimezoneOffset() * 60000;\r\n            const adjustedDate = new Date(newDate.getTime() + userTimezoneOffset);\r\n            setSelectedDate(adjustedDate);\r\n\r\n            resetForm();\r\n\r\n\r\n            // 1. Redirecionar para a data do novo agendamento\r\n            const newDateStr = selectedAppointmentDate;\r\n            navigate(`/agenda?date=${newDateStr}`);\r\n\r\n\r\n        } catch (error) {\r\n            console.error('Error creating appointment:', error);\r\n            alert('Erro ao criar agendamento.');\r\n        }\r\n    };\r\n\r\n    const changeDate = (days: number) => {\r\n        const newDate = new Date(selectedDate);\r\n        newDate.setDate(newDate.getDate() + days);\r\n\r\n        // Atualiza a URL para refletir a nova data\r\n        const newDateStr = newDate.toISOString().split('T')[0];\r\n        navigate(`/agenda?date=${newDateStr}`);\r\n    };\r\n\r\n    const changeHistoryMonth = (months: number) => {\r\n        const newMonth = new Date(historyMonth);\r\n        newMonth.setMonth(newMonth.getMonth() + months);\r\n        setHistoryMonth(newMonth);\r\n    };\r\n\r\n    const getAppointmentsForProfessional = (professionalId: string) => {\r\n        return appointments.filter(apt => apt.professional_id === professionalId);\r\n    };\r\n\r\n    const getPendingBookingsForProfessional = (professionalId: string) => {\r\n        return publicBookings.filter(booking => booking.professional_id === professionalId);\r\n    };\r\n\r\n    // Generate time slots with half-hour intervals\r\n    const timeSlots = [];\r\n    for (let hour = 8; hour <= 20; hour++) {\r\n        timeSlots.push(`${hour.toString().padStart(2, '0')}:00`);\r\n        if (hour < 20) {\r\n            timeSlots.push(`${hour.toString().padStart(2, '0')}:30`);\r\n        }\r\n    }\r\n\r\n    // Filtrar profissionais exibidos\r\n    const displayedMembers = selectedProfessionalFilter\r\n        ? teamMembers.filter(m => m.id === selectedProfessionalFilter)\r\n        : teamMembers;\r\n\r\n    // Prepare options for SearchableSelect\r\n    const clientOptions = clients.map(c => ({\r\n        id: c.id,\r\n        name: c.name,\r\n        subtext: (c as any).phone // Assuming phone is available on client object\r\n    }));\r\n\r\n    const serviceOptions = services.map(s => ({\r\n        id: s.id,\r\n        name: s.name,\r\n        subtext: `${formatCurrency(s.price, currencyRegion)} | ${s.duration_minutes} min` // Using generic currency formatting\r\n    }));\r\n\r\n    // Calculate price preview for the modal\r\n    // Values are now calculated at the top level for the useEffect sync\r\n    // const selectedServicesDetails... (moved up)\r\n    // const basePriceNew... (moved up)\r\n    // const discountRateNew... (moved up)\r\n    // const finalPriceNew... (moved up)\r\n\r\n    // Helper to calculate discount info for display\r\n    const getDiscountInfo = (apt: Appointment) => {\r\n        // Check if the saved price is lower than the base price of the service\r\n        const hasDiscount = apt.basePrice && apt.price < apt.basePrice;\r\n\r\n        // Check if the saved price is higher than the base price (custom price)\r\n        const isCustomPriceHigher = apt.basePrice && apt.price > apt.basePrice;\r\n\r\n        if (hasDiscount) {\r\n            const discountAmount = apt.basePrice! - apt.price;\r\n            const discountPercentage = Math.round((discountAmount / apt.basePrice!) * 100);\r\n            return {\r\n                hasDiscount: true,\r\n                basePrice: apt.basePrice,\r\n                discountAmount: discountAmount,\r\n                discountPercentage: discountPercentage,\r\n                isCustomPriceHigher: false\r\n            };\r\n        } else if (isCustomPriceHigher) {\r\n            // If price is higher, treat it as a custom price without discount\r\n            return {\r\n                hasDiscount: false,\r\n                basePrice: apt.basePrice,\r\n                discountAmount: 0,\r\n                discountPercentage: 0,\r\n                isCustomPriceHigher: true\r\n            };\r\n        }\r\n\r\n        return { hasDiscount: false, basePrice: apt.basePrice, discountAmount: 0, discountPercentage: 0, isCustomPriceHigher: false };\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen\">\r\n                <div className=\"text-white text-xl\">Carregando agenda...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div>\r\n                    <h1 className=\"text-3xl md:text-4xl font-heading text-white uppercase\">Agenda</h1>\r\n                    <p className=\"text-neutral-400 mt-1\">Gerencie os agendamentos por profissional</p>\r\n                </div>\r\n                <div className=\"flex gap-3 w-full md:w-auto\">\r\n                    <BrutalButton\r\n                        variant=\"secondary\"\r\n                        icon={<History />}\r\n                        onClick={() => {\r\n                            setShowHistoryModal(true);\r\n                            // No need to call fetchHistoryAppointments here, useEffect will handle it\r\n                        }}\r\n                        className=\"flex-1 md:flex-none\"\r\n                    >\r\n                        Hist√≥rico\r\n                    </BrutalButton>\r\n                    <BrutalButton\r\n                        variant=\"primary\"\r\n                        icon={<Plus />}\r\n                        onClick={() => navigate('?new=true')}\r\n                        className=\"flex-1 md:flex-none\"\r\n                    >\r\n                        Novo Agendamento\r\n                    </BrutalButton>\r\n                </div>\r\n            </div>\r\n\r\n            {/* --- NOVO: Agendamentos Atrasados (Overdue) --- */}\r\n            {isOverdueFilter && (\r\n                <BrutalCard className=\"border-l-4 border-red-600 bg-red-900/20\">\r\n                    <div className=\"flex items-start gap-4\">\r\n                        <AlertTriangle className=\"w-6 h-6 text-red-500 flex-shrink-0 mt-1\" />\r\n                        <div className=\"flex-1\">\r\n                            <h3 className=\"text-white font-heading text-lg uppercase mb-2\">\r\n                                üö® Agendamentos Atrasados ({overdueAppointments.length})\r\n                            </h3>\r\n                            <p className=\"text-neutral-300 text-sm mb-4\">\r\n                                Estes agendamentos est√£o no passado e precisam ser marcados como Conclu√≠dos (para faturamento) ou Cancelados.\r\n                            </p>\r\n\r\n                            {isOverdueLoading ? (\r\n                                <div className=\"flex items-center gap-2 text-neutral-400\">\r\n                                    <Loader2 className=\"w-4 h-4 animate-spin\" /> Carregando...\r\n                                </div>\r\n                            ) : overdueAppointments.length === 0 ? (\r\n                                <p className=\"text-green-400 text-sm\">Nenhum agendamento atrasado encontrado. ‚úÖ</p>\r\n                            ) : (\r\n                                <div className=\"space-y-3 max-h-64 overflow-y-auto pr-2\">\r\n                                    {overdueAppointments.map(apt => {\r\n                                        const professional = teamMembers.find(m => m.id === apt.professional_id);\r\n                                        return (\r\n                                            <div key={apt.id} className=\"bg-neutral-900 p-3 rounded-lg border border-red-800 flex items-center justify-between\">\r\n                                                <div>\r\n                                                    <p className=\"text-white font-bold text-sm\">{apt.clientName}</p>\r\n                                                    <p className=\"text-neutral-400 text-xs\">{apt.service}</p>\r\n                                                    <p className=\"text-neutral-500 text-xs\">\r\n                                                        {new Date(apt.appointment_time).toLocaleDateString('pt-BR')} √†s {new Date(apt.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                                        {professional && ` | Profissional: ${professional.name}`}\r\n                                                    </p>\r\n                                                </div>\r\n                                                <div className=\"flex gap-2 flex-shrink-0\">\r\n                                                    <button\r\n                                                        onClick={() => handleCompleteAppointment(apt.id, true)}\r\n                                                        className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors\"\r\n                                                        title=\"Concluir e Faturar\"\r\n                                                    >\r\n                                                        <Check className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => handleCancelAppointment(apt.id, true)}\r\n                                                        className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors\"\r\n                                                        title=\"Cancelar\"\r\n                                                    >\r\n                                                        <X className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </BrutalCard>\r\n            )}\r\n            {/* --- FIM: Agendamentos Atrasados --- */}\r\n\r\n\r\n            {/* Date Navigator */}\r\n            <BrutalCard>\r\n                <div className=\"flex items-center justify-between\">\r\n                    <button\r\n                        onClick={() => changeDate(-1)}\r\n                        className=\"p-2 hover:bg-white/10 rounded-lg transition-colors\"\r\n                    >\r\n                        <ChevronLeft className=\"w-6 h-6 text-white\" />\r\n                    </button>\r\n                    <div className=\"text-center\">\r\n                        <h2 className={`text-2xl font-heading ${accentText} uppercase`}>\r\n                            {selectedDate.toLocaleDateString('pt-BR', { weekday: 'long' })}\r\n                        </h2>\r\n                        <p className=\"text-white text-lg font-mono\">\r\n                            {selectedDate.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' })}\r\n                        </p>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => changeDate(1)}\r\n                        className=\"p-2 hover:bg-white/10 rounded-lg transition-colors\"\r\n                    >\r\n                        <ChevronRight className=\"w-6 h-6 text-white\" />\r\n                    </button>\r\n                </div>\r\n            </BrutalCard>\r\n\r\n            {/* Professional Filter */}\r\n            {teamMembers.length > 0 && (\r\n                <BrutalCard>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                        <button\r\n                            onClick={() => setSelectedProfessionalFilter(null)}\r\n                            className={`px-4 py-2 rounded-lg font-bold transition-all border-2 ${selectedProfessionalFilter === null\r\n                                ? `${accentBg} text-black border-black`\r\n                                : 'bg-neutral-800 text-neutral-400 border-neutral-700 hover:border-neutral-600'\r\n                                }`}\r\n                        >\r\n                            Todos os Profissionais\r\n                        </button>\r\n                        {teamMembers.map(member => (\r\n                            <button\r\n                                key={member.id}\r\n                                onClick={() => setSelectedProfessionalFilter(member.id)}\r\n                                className={`px-4 py-2 rounded-lg font-bold transition-all border-2 flex items-center gap-2 ${selectedProfessionalFilter === member.id\r\n                                    ? `${accentBg} text-black border-black`\r\n                                    : 'bg-neutral-800 text-white border-neutral-700 hover:border-neutral-600'\r\n                                    }`}\r\n                            >\r\n                                {member.photo_url && (\r\n                                    <img\r\n                                        src={member.photo_url}\r\n                                        alt={member.name}\r\n                                        className=\"w-6 h-6 rounded-full border border-black object-cover\"\r\n                                    />\r\n                                )}\r\n                                {member.name}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </BrutalCard>\r\n            )}\r\n\r\n            {/* Pending Public Bookings Alert */}\r\n            {publicBookings.length > 0 && (\r\n                <div className=\"space-y-4\">\r\n                    <BrutalCard className=\"border-l-4 border-accent-gold bg-accent-gold/5\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <AlertTriangle className=\"w-6 h-6 text-accent-gold\" />\r\n                            <div>\r\n                                <h3 className=\"text-white font-bold text-lg mb-1\">\r\n                                    üìå {publicBookings.length} Solicita√ß√£o(√µes) Pendente(s)\r\n                                </h3>\r\n                                <p className=\"text-neutral-400 text-sm\">\r\n                                    Os agendamentos abaixo foram feitos online e aguardam sua aprova√ß√£o:\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </BrutalCard>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                        {publicBookings.map(booking => {\r\n                            const professional = teamMembers.find(m => m.id === booking.professional_id);\r\n                            const bookingDate = new Date(booking.appointment_time);\r\n                            const isToday = bookingDate.toDateString() === new Date().toDateString();\r\n\r\n                            return (\r\n                                <div key={booking.id} className={`\r\n                                    relative p-5 transition-all duration-300 group\r\n                                    ${isBeauty\r\n                                        ? 'bg-beauty-card/40 backdrop-blur-md border border-beauty-neon/30 rounded-2xl hover:border-beauty-neon shadow-neon-sm hover:shadow-neon'\r\n                                        : 'bg-neutral-900 border-2 border-accent-gold/50 rounded-xl hover:border-accent-gold shadow-heavy-sm'\r\n                                    }\r\n                                `}>\r\n                                    <div className=\"flex items-start justify-between mb-4\">\r\n                                        <div>\r\n                                            <span className={`\r\n                                                text-[10px] font-mono font-bold px-2 py-1 rounded border transition-colors\r\n                                                ${isToday\r\n                                                    ? (isBeauty ? 'bg-beauty-neon text-black border-beauty-neon' : 'bg-accent-gold text-black border-accent-gold')\r\n                                                    : 'bg-neutral-800 text-neutral-400 border-neutral-700 group-hover:text-white'\r\n                                                }\r\n                                            `}>\r\n                                                {isToday ? 'HOJE' : bookingDate.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })} ‚Ä¢ {bookingDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <button\r\n                                                onClick={() => handleAcceptBooking(booking)}\r\n                                                className={`p-2 rounded-lg transition-all shadow-lg hover:scale-110 active:scale-95 ${isBeauty ? 'bg-beauty-neon text-black hover:bg-white' : 'bg-green-600 text-white hover:bg-green-500'}`}\r\n                                                title=\"Aceitar\"\r\n                                            >\r\n                                                <Check className=\"w-4 h-4\" />\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => handleRejectBooking(booking.id)}\r\n                                                className=\"p-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-all shadow-lg hover:scale-110 active:scale-95\"\r\n                                                title=\"Recusar\"\r\n                                            >\r\n                                                <X className=\"w-4 h-4\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"space-y-1\">\r\n                                        <p className=\"text-white font-bold text-xl leading-tight group-hover:text-beauty-neon transition-colors\">{booking.customer_name}</p>\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            <span className=\"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse\"></span>\r\n                                            <p className=\"text-neutral-400 text-sm font-mono tracking-wider\">\r\n                                                {formatPhone(booking.customer_phone, currencyRegion)}\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"mt-4 pt-4 border-t border-white/10 space-y-3\">\r\n                                        <div className=\"flex items-center gap-3 text-xs text-neutral-300\">\r\n                                            <div className={`p-1.5 rounded-lg ${isBeauty ? 'bg-beauty-neon/10' : 'bg-accent-gold/10'}`}>\r\n                                                <Scissors className={`w-3.5 h-3.5 ${isBeauty ? 'text-beauty-neon' : 'text-accent-gold'}`} />\r\n                                            </div>\r\n                                            <span className=\"font-medium\">\r\n                                                {booking.service_ids?.length || 0} servi√ßo(s) ‚Ä¢ <span className=\"text-white font-bold\">{formatCurrency(booking.total_price, currencyRegion)}</span>\r\n                                            </span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-3 text-xs text-neutral-300\">\r\n                                            <div className={`p-1.5 rounded-lg ${isBeauty ? 'bg-beauty-neon/10' : 'bg-accent-gold/10'}`}>\r\n                                                <User className={`w-3.5 h-3.5 ${isBeauty ? 'text-beauty-neon' : 'text-accent-gold'}`} />\r\n                                            </div>\r\n                                            <span>\r\n                                                Profissional: <span className=\"font-bold text-white uppercase tracking-tighter\">{professional?.name || 'Qualquer um'}</span>\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                    <div className=\"border-b-2 border-neutral-800 my-8\"></div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Team Columns */}\r\n            {teamMembers.length === 0 ? (\r\n                <BrutalCard>\r\n                    <div className=\"text-center py-12\">\r\n                        <User className=\"w-16 h-16 text-neutral-600 mx-auto mb-4\" />\r\n                        <h3 className=\"text-white font-bold text-xl mb-2\">Nenhum profissional cadastrado</h3>\r\n                        <p className=\"text-neutral-400 mb-6\">\r\n                            Adicione profissionais √† sua equipe para come√ßar a organizar agendamentos\r\n                        </p>\r\n                        <BrutalButton variant=\"secondary\" onClick={() => navigate('/configuracoes/equipe')}>\r\n                            Adicionar Profissionais\r\n                        </BrutalButton>\r\n                    </div>\r\n                </BrutalCard>\r\n            ) : (\r\n                <div className={`grid gap-4 ${selectedProfessionalFilter\r\n                    ? 'grid-cols-1 max-w-2xl mx-auto'\r\n                    : `grid-cols-1 md:grid-cols-${Math.min((teamMembers.length + (appointments.some(a => !a.professional_id) ? 1 : 0)), 4)}`\r\n                    } overflow-x-auto pb-4`}>\r\n\r\n                    {/* Unassigned Column (if any unassigned appointments exist) */}\r\n                    {appointments.some(apt => !apt.professional_id) && !selectedProfessionalFilter && (\r\n                        <div className=\"bg-neutral-900/50 border border-neutral-800 rounded-xl overflow-hidden flex flex-col h-full opacity-70 hover:opacity-100 transition-opacity min-w-[300px]\">\r\n                            <div className=\"p-4 bg-neutral-800 border-b border-neutral-700 flex items-center justify-between sticky top-0 z-10\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"w-10 h-10 rounded-full bg-neutral-700 flex items-center justify-center border border-neutral-600\">\r\n                                        <Users className=\"w-5 h-5 text-neutral-400\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"font-bold text-white uppercase tracking-wider text-sm\">A Distribuir</h3>\r\n                                        <p className=\"text-[10px] bg-red-500/20 text-red-400 px-2 py-0.5 rounded-full inline-block mt-1\">\r\n                                            Sem profissional\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"p-4 space-y-3 flex-1 overflow-y-auto max-h-[800px]\">\r\n                                {appointments.filter(apt => !apt.professional_id).map(apt => {\r\n                                    const { hasDiscount } = getDiscountInfo(apt);\r\n                                    return (\r\n                                        <div\r\n                                            key={apt.id}\r\n                                            className=\"border-2 border-neutral-700 rounded-lg p-3 bg-neutral-800 hover:border-neutral-500 transition-colors\"\r\n                                        >\r\n                                            <div className=\"flex items-start justify-between mb-2\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"text-xs font-mono font-bold text-white\">\r\n                                                        {new Date(apt.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                                    </span>\r\n                                                    <span className=\"text-xs font-mono text-neutral-500\">\r\n                                                        {new Date(apt.appointment_time).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}\r\n                                                    </span>\r\n                                                </div>\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <button\r\n                                                        onClick={() => setEditingAppointment(apt)}\r\n                                                        className=\"text-neutral-400 hover:text-white transition-colors\"\r\n                                                        title=\"Editar / Atribuir\"\r\n                                                    >\r\n                                                        <Edit2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                            <p className=\"text-white font-bold text-sm mb-1\">{apt.clientName}</p>\r\n                                            <p className=\"text-neutral-400 text-xs mb-1\">{apt.service}</p>\r\n                                            <span className={`text-xs font-mono font-bold ${accentText}`}>\r\n                                                {formatCurrency(apt.price, currencyRegion)}\r\n                                            </span>\r\n                                            <div className=\"mt-2 text-[10px] text-red-400 flex items-center gap-1\">\r\n                                                <AlertTriangle className=\"w-3 h-3\" /> Necess√°rio atribuir profissional\r\n                                            </div>\r\n                                            {teamMembers.length === 1 && (\r\n                                                <button\r\n                                                    onClick={() => handleAssignToProfessional(apt.id, teamMembers[0].id)}\r\n                                                    className={`mt-2 w-full font-bold text-[10px] py-2 rounded-lg transition-all flex items-center justify-center gap-1 ${isBeauty ? 'bg-beauty-neon text-black hover:bg-white' : 'bg-green-600 text-white hover:bg-green-500'}`}\r\n                                                >\r\n                                                    <Check className=\"w-3 h-3\" /> ATRIBUIR A {teamMembers[0].name.toUpperCase()}\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    {displayedMembers.map(member => {\r\n                        const memberAppointments = getAppointmentsForProfessional(member.id);\r\n                        const memberPendingBookings = getPendingBookingsForProfessional(member.id);\r\n\r\n                        return (\r\n                            <div key={member.id} className=\"flex flex-col\">\r\n                                {/* Professional Header */}\r\n                                <div\r\n                                    onClick={() => {\r\n                                        setSelectedProfessional(member.id);\r\n                                        setShowNewAppointmentModal(true);\r\n                                    }}\r\n                                    className={`${isBeauty\r\n                                        ? 'bg-gradient-to-r from-beauty-neon/20 to-beauty-neon/5 hover:from-beauty-neon/30'\r\n                                        : 'bg-accent-gold hover:opacity-90'} text-white p-4 rounded-t-lg border-2 border-b-0 border-white/20 min-h-[90px] flex items-center cursor-pointer transition-all group relative`}\r\n                                    title=\"Clique para agendar com este profissional\">\r\n                                    <div className=\"flex items-center gap-3 w-full\">\r\n                                        {member.photo_url ? (\r\n                                            <img\r\n                                                src={member.photo_url}\r\n                                                alt={member.name}\r\n                                                className=\"w-12 h-12 rounded-full border-2 border-white/30 object-cover flex-shrink-0\"\r\n                                            />\r\n                                        ) : (\r\n                                            <div className=\"w-12 h-12 rounded-full bg-white/10 border-2 border-white/30 flex items-center justify-center flex-shrink-0\">\r\n                                                <User className=\"w-6 h-6 text-white\" />\r\n                                            </div>\r\n                                        )}\r\n                                        <div className=\"flex-1 min-w-0\">\r\n                                            <h3 className={`font-heading font-bold text-lg truncate uppercase ${isBeauty ? 'text-white' : 'text-black'}`} title={member.name}>\r\n                                                {member.name}\r\n                                            </h3>\r\n                                            <div className=\"flex items-center gap-2 mt-1\">\r\n                                                <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full ${isBeauty ? 'bg-beauty-neon/20 text-beauty-neon' : 'bg-black/10 text-black/70'}`}>\r\n                                                    {memberAppointments.length} agendamentos\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity bg-black/20 p-1 rounded-full\">\r\n                                        <Plus className={`w-4 h-4 ${isBeauty ? 'text-white' : 'text-black'}`} />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Appointments Column - Limited Height with Scroll */}\r\n                                <div className=\"bg-neutral-900 border-2 border-t-0 border-black rounded-b-lg p-3 h-[400px] overflow-y-auto space-y-2 scrollbar-thin scrollbar-thumb-neutral-700 scrollbar-track-neutral-900\">\r\n                                    {/* Pending Public Bookings */}\r\n                                    {memberPendingBookings.map(booking => (\r\n                                        <div\r\n                                            key={booking.id}\r\n                                            className=\"bg-accent-gold/10 border-2 border-accent-gold rounded-lg p-3\"\r\n                                        >\r\n                                            <div className=\"flex items-start justify-between mb-2\">\r\n                                                <span className=\"text-xs font-mono text-accent-gold font-bold\">\r\n                                                    üìå SOLICITA√á√ÉO ONLINE\r\n                                                </span>\r\n                                            </div>\r\n                                            <p className=\"text-white font-bold text-sm mb-1\">{booking.customer_name}</p>\r\n                                            <p className=\"text-neutral-400 text-xs mb-1\">\r\n                                                {/* Note: booking.services is an array of IDs here, not objects. We need to map them if possible, but for now, we'll show the service IDs array length */}\r\n                                                {booking.service_ids?.length} servi√ßo(s)\r\n                                            </p>\r\n                                            <p className=\"text-neutral-500 text-xs mb-3\">\r\n                                                {new Date(booking.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                            </p>\r\n                                            <div className=\"flex gap-2\">\r\n                                                <button\r\n                                                    onClick={() => handleAcceptBooking(booking)}\r\n                                                    disabled={isProcessing}\r\n                                                    className={`flex-1 ${isProcessing ? 'bg-neutral-700 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700'} text-white text-xs font-bold py-2 px-3 rounded-lg transition-colors flex items-center justify-center gap-1`}\r\n                                                >\r\n                                                    {isProcessing ? <Loader2 className=\"w-3 h-3 animate-spin\" /> : <Check className=\"w-3 h-3\" />}\r\n                                                    {isProcessing ? '...' : 'Aceitar'}\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => handleRejectBooking(booking.id)}\r\n                                                    disabled={isProcessing}\r\n                                                    className={`flex-1 ${isProcessing ? 'bg-neutral-700 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700'} text-white text-xs font-bold py-2 px-3 rounded-lg transition-colors flex items-center justify-center gap-1`}\r\n                                                >\r\n                                                    <X className=\"w-3 h-3\" />\r\n                                                    Recusar\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n\r\n                                    {/* Confirmed Appointments */}\r\n\r\n                                    {memberAppointments.map(apt => {\r\n                                        const { hasDiscount, discountPercentage, isCustomPriceHigher } = getDiscountInfo(apt);\r\n                                        const isCompleted = apt.status === 'Completed';\r\n\r\n                                        return (\r\n                                            <div\r\n                                                key={apt.id}\r\n                                                className={`border rounded-xl p-4 transition-all hover:scale-[1.01] ${isCompleted\r\n                                                    ? 'bg-neutral-900/50 border-neutral-800 opacity-70 hover:opacity-100'\r\n                                                    : 'bg-neutral-800 border-neutral-700 hover:border-neutral-600 shadow-lg'\r\n                                                    }`}\r\n                                            >\r\n                                                <div className=\"flex items-start justify-between mb-3\">\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <span className={`text-sm font-mono font-bold ${isCompleted ? 'text-green-500 line-through decoration-2' : accentText}`}>\r\n                                                            {new Date(apt.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                                        </span>\r\n                                                    </div>\r\n\r\n                                                    {/* Action Buttons Row */}\r\n                                                    <div className=\"flex items-center gap-1 opacity-80 hover:opacity-100\">\r\n                                                        {apt.status === 'Confirmed' && (\r\n                                                            <>\r\n                                                                {/* Notes and WhatsApp buttons remain similar but smaller */}\r\n                                                                <button onClick={() => setShowingDetailsAppointment(apt)} className=\"p-1 hover:bg-white/10 rounded transition-colors\" title=\"Ver detalhes e observa√ß√µes\">\r\n                                                                    <Info className={`w-3.5 h-3.5 ${apt.notes ? 'text-blue-400' : 'text-neutral-500'}`} />\r\n                                                                </button>\r\n                                                                {apt.clientPhone && (\r\n                                                                    <button\r\n                                                                        onClick={() => {\r\n                                                                            const waPhone = apt.clientPhone!.replace(/\\D/g, '');\r\n                                                                            window.open(`https://wa.me/${waPhone}?text=${encodeURIComponent('Seu agendamento foi confirmado')}`, '_blank');\r\n                                                                        }}\r\n                                                                        className=\"p-1 hover:bg-white/10 rounded transition-colors\"\r\n                                                                        title=\"WhatsApp\"\r\n                                                                    >\r\n                                                                        <MessageCircle className=\"w-3.5 h-3.5 text-green-500\" />\r\n                                                                    </button>\r\n                                                                )}\r\n\r\n                                                                <div className=\"w-px h-3 bg-white/10 mx-1\"></div>\r\n\r\n                                                                <button onClick={() => setEditingAppointment(apt)} className=\"p-1 hover:bg-white/10 rounded transition-colors\" title=\"Editar\">\r\n                                                                    <Edit2 className=\"w-3.5 h-3.5 text-neutral-400 hover:text-white\" />\r\n                                                                </button>\r\n                                                                <button onClick={() => handleCompleteAppointment(apt.id)} className=\"p-1 hover:bg-white/10 rounded transition-colors\" title=\"Concluir\">\r\n                                                                    <Check className=\"w-3.5 h-3.5 text-green-500\" />\r\n                                                                </button>\r\n                                                                <button onClick={() => handleCancelAppointment(apt.id)} className=\"p-1 hover:bg-white/10 rounded transition-colors\" title=\"Cancelar\">\r\n                                                                    <X className=\"w-3.5 h-3.5 text-red-500\" />\r\n                                                                </button>\r\n                                                            </>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-1 mb-3\">\r\n                                                    <p className={`font-bold text-base truncate ${isCompleted ? 'text-neutral-500' : 'text-white'}`}>\r\n                                                        {apt.clientName}\r\n                                                    </p>\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <Scissors className=\"w-3 h-3 text-neutral-500\" />\r\n                                                        <p className=\"text-neutral-400 text-xs truncate max-w-[180px]\" title={apt.service}>\r\n                                                            {apt.service}\r\n                                                        </p>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"pt-3 border-t border-white/5 flex items-center justify-between\">\r\n                                                    <div className=\"flex flex-col\">\r\n                                                        {hasDiscount && apt.basePrice && (\r\n                                                            <span className=\"text-[10px] text-neutral-500 line-through\">\r\n                                                                {formatCurrency(apt.basePrice, currencyRegion)}\r\n                                                            </span>\r\n                                                        )}\r\n                                                        <span className={`text-sm font-bold ${isCompleted ? 'text-neutral-500' : 'text-white'}`}>\r\n                                                            {formatCurrency(apt.price, currencyRegion)}\r\n                                                        </span>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"flex flex-col gap-1 items-end\">\r\n                                                        {hasDiscount && (\r\n                                                            <span className=\"text-[10px] font-bold px-1.5 py-0.5 rounded bg-red-500/10 text-red-400 border border-red-500/20\">\r\n                                                                -{discountPercentage}%\r\n                                                            </span>\r\n                                                        )}\r\n                                                        {isCustomPriceHigher && (\r\n                                                            <span className=\"text-[10px] font-bold px-1.5 py-0.5 rounded bg-blue-500/10 text-blue-400 border border-blue-500/20\">\r\n                                                                Custom\r\n                                                            </span>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n\r\n                                    {memberAppointments.length === 0 && memberPendingBookings.length === 0 && (\r\n                                        <div className=\"flex flex-col items-center justify-center h-full text-center p-6 opacity-60\">\r\n                                            <div className=\"w-16 h-16 rounded-full bg-white/5 flex items-center justify-center mb-3\">\r\n                                                <Calendar className=\"w-8 h-8 text-neutral-600\" />\r\n                                            </div>\r\n                                            <p className=\"text-sm font-bold text-neutral-400\">Livre</p>\r\n                                            <p className=\"text-xs text-neutral-600 mt-1\">Nenhum agendamento</p>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            )}\r\n\r\n            {/* Appointment Details Modal */}\r\n            {showingDetailsAppointment && (\r\n                <div className={`fixed inset-0 z-50 flex items-center justify-center p-4 ${isBeauty ? 'bg-beauty-dark/80 backdrop-blur-sm' : 'bg-black/80'}`}>\r\n                    <div className={`w-full max-w-md p-0 overflow-hidden relative transition-all animate-in fade-in zoom-in duration-300\r\n                        ${isBeauty\r\n                            ? 'bg-beauty-card border border-beauty-neon/30 rounded-2xl shadow-[0_0_30px_rgba(167,139,250,0.2)]'\r\n                            : 'bg-neutral-900 border-2 border-white rounded-xl shadow-[8px_8px_0px_0px_#ffffff]'}\r\n                    `}>\r\n                        {/* Header */}\r\n                        <div className={`p-6 ${isBeauty ? 'bg-gradient-to-r from-beauty-neon/20 to-transparent' : 'bg-white text-black'}`}>\r\n                            <div className=\"flex justify-between items-start\">\r\n                                <div>\r\n                                    <h3 className={`font-heading text-xl uppercase mb-1 ${isBeauty ? 'text-white' : 'text-black'}`}>\r\n                                        Detalhes do Agendamento\r\n                                    </h3>\r\n                                    <span className={`text-xs font-mono font-bold px-2 py-1 rounded inline-block ${showingDetailsAppointment.status === 'Completed' ? 'bg-green-500 text-black' :\r\n                                        (isBeauty ? 'bg-beauty-neon text-black' : 'bg-black text-white')\r\n                                        }`}>\r\n                                        {showingDetailsAppointment.status === 'Completed' ? '‚úì CONCLU√çDO' : '‚óè CONFIRMADO'}\r\n                                    </span>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => setShowingDetailsAppointment(null)}\r\n                                    className={`p-1 rounded-full hover:bg-black/10 transition-colors ${isBeauty ? 'text-white hover:bg-white/10' : 'text-black'}`}\r\n                                >\r\n                                    <X className=\"w-6 h-6\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Body */}\r\n                        <div className=\"p-6 space-y-6\">\r\n                            {/* Client Info */}\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold\r\n                                    ${isBeauty ? 'bg-beauty-neon/10 text-beauty-neon border border-beauty-neon/30' : 'bg-neutral-800 text-white border border-neutral-700'}`}>\r\n                                    {showingDetailsAppointment.clientName.charAt(0).toUpperCase()}\r\n                                </div>\r\n                                <div>\r\n                                    <p className=\"text-sm text-neutral-400 font-mono mb-0.5\">Cliente</p>\r\n                                    <h4 className=\"text-lg font-bold text-white\">{showingDetailsAppointment.clientName}</h4>\r\n                                    {showingDetailsAppointment.clientPhone && (\r\n                                        <div className=\"flex items-center gap-2 mt-1\">\r\n                                            <span className=\"text-xs text-neutral-400 font-mono bg-neutral-800 px-2 py-0.5 rounded\">\r\n                                                {formatPhone(showingDetailsAppointment.clientPhone, currencyRegion)}\r\n                                            </span>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"w-full h-px bg-white/10\"></div>\r\n\r\n                            {/* Service & Professional */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 mb-2 text-neutral-400\">\r\n                                        <Scissors className=\"w-4 h-4\" />\r\n                                        <span className=\"text-xs uppercase tracking-wider font-bold\">Servi√ßo</span>\r\n                                    </div>\r\n                                    <p className=\"text-white font-medium text-sm\">{showingDetailsAppointment.service}</p>\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 mb-2 text-neutral-400\">\r\n                                        <User className=\"w-4 h-4\" />\r\n                                        <span className=\"text-xs uppercase tracking-wider font-bold\">Profissional</span>\r\n                                    </div>\r\n                                    <p className=\"text-white font-medium text-sm\">\r\n                                        {teamMembers.find(m => m.id === showingDetailsAppointment.professional_id)?.name || 'N/A'}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Time & Price */}\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 mb-2 text-neutral-400\">\r\n                                        <Clock className=\"w-4 h-4\" />\r\n                                        <span className=\"text-xs uppercase tracking-wider font-bold\">Data e Hora</span>\r\n                                    </div>\r\n                                    <p className=\"text-white font-medium text-sm\">\r\n                                        {new Date(showingDetailsAppointment.appointment_time).toLocaleDateString('pt-BR')}\r\n                                    </p>\r\n                                    <p className={`font-mono font-bold ${accentText}`}>\r\n                                        {new Date(showingDetailsAppointment.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                    </p>\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"flex items-center gap-2 mb-2 text-neutral-400\">\r\n                                        <DollarSign className=\"w-4 h-4\" />\r\n                                        <span className=\"text-xs uppercase tracking-wider font-bold\">Valor</span>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        {(() => {\r\n                                            const { hasDiscount, basePrice } = getDiscountInfo(showingDetailsAppointment);\r\n                                            return (\r\n                                                <>\r\n                                                    {hasDiscount && basePrice && (\r\n                                                        <span className=\"text-xs text-red-500 line-through font-mono\">\r\n                                                            {formatCurrency(basePrice, currencyRegion)}\r\n                                                        </span>\r\n                                                    )}\r\n                                                    <span className=\"text-xl font-bold text-white font-mono\">\r\n                                                        {formatCurrency(showingDetailsAppointment.price, currencyRegion)}\r\n                                                    </span>\r\n                                                </>\r\n                                            );\r\n                                        })()}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Notes Section - Prominent */}\r\n                            {showingDetailsAppointment.notes && (\r\n                                <div className={`p-4 rounded-xl border ${isBeauty\r\n                                    ? 'bg-beauty-neon/5 border-beauty-neon/20'\r\n                                    : 'bg-yellow-500/5 border-yellow-500/20'\r\n                                    }`}>\r\n                                    <div className=\"flex items-center gap-2 mb-2\">\r\n                                        <Info className={`w-4 h-4 ${isBeauty ? 'text-beauty-neon' : 'text-yellow-500'}`} />\r\n                                        <span className={`text-xs font-bold uppercase tracking-wider ${isBeauty ? 'text-beauty-neon' : 'text-yellow-500'}`}>\r\n                                            Observa√ß√µes\r\n                                        </span>\r\n                                    </div>\r\n                                    <p className=\"text-neutral-300 text-sm leading-relaxed italic\">\r\n                                        &quot;{showingDetailsAppointment.notes}&quot;\r\n                                    </p>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Footer Actions */}\r\n                        <div className=\"p-4 border-t border-white/10 bg-black/20 flex gap-3\">\r\n                            {showingDetailsAppointment.status === 'Confirmed' && (\r\n                                <button\r\n                                    onClick={() => {\r\n                                        setEditingAppointment(showingDetailsAppointment);\r\n                                        setShowingDetailsAppointment(null);\r\n                                    }}\r\n                                    className=\"flex-1 bg-neutral-800 hover:bg-neutral-700 text-white py-3 rounded-lg font-bold transition-colors border border-white/10 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <Edit2 className=\"w-4 h-4\" /> Editar\r\n                                </button>\r\n                            )}\r\n                            <button\r\n                                onClick={() => setShowingDetailsAppointment(null)}\r\n                                className={`flex-1 py-3 rounded-lg font-bold transition-colors ${isBeauty\r\n                                    ? 'bg-beauty-neon text-black hover:bg-beauty-neon/90'\r\n                                    : 'bg-white text-black hover:bg-neutral-200'\r\n                                    }`}\r\n                            >\r\n                                Fechar\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* History Modal */}\r\n            {showHistoryModal && (\r\n                <div className={`fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto ${isBeauty ? 'bg-beauty-dark/80 backdrop-blur-sm' : 'bg-black/80'}`}>\r\n                    <div className={`w-full max-w-4xl p-6 my-8 transition-all\r\n                        ${isBeauty\r\n                            ? 'bg-gradient-to-br from-beauty-card to-beauty-dark border border-beauty-neon/30 rounded-2xl shadow-[0_0_20px_rgba(167,139,250,0.15)]'\r\n                            : 'bg-neutral-900 border-2 border-neutral-800 rounded-xl shadow-[8px_8px_0px_0px_#000000]'}\r\n                    `}>\r\n                        <div className=\"flex items-center justify-between mb-6\">\r\n                            <h3 className=\"text-white font-heading text-2xl uppercase\">Hist√≥rico de Agendamentos</h3>\r\n                            <button\r\n                                onClick={() => setShowHistoryModal(false)}\r\n                                className=\"text-neutral-400 hover:text-white transition-colors\"\r\n                            >\r\n                                <X className=\"w-6 h-6\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Month Navigator */}\r\n                        <div className=\"flex items-center justify-between mb-6 bg-neutral-800 p-4 rounded-lg border border-neutral-700\">\r\n                            <button\r\n                                onClick={() => {\r\n                                    changeHistoryMonth(-1);\r\n                                }}\r\n                                className=\"p-2 hover:bg-white/10 rounded-lg transition-colors\"\r\n                            >\r\n                                <ChevronLeft className=\"w-5 h-5 text-white\" />\r\n                            </button>\r\n                            <div className=\"text-center\">\r\n                                <p className={`text-xl font-heading ${accentText} uppercase`}>\r\n                                    {historyMonth.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' })}\r\n                                </p>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => {\r\n                                    changeHistoryMonth(1);\r\n                                }}\r\n                                className=\"p-2 hover:bg-white/10 rounded-lg transition-colors\"\r\n                            >\r\n                                <ChevronRight className=\"w-5 h-5 text-white\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* History List */}\r\n                        <div className=\"space-y-3 max-h-[500px] overflow-y-auto pr-2\">\r\n                            {historyAppointments.length === 0 ? (\r\n                                <div className=\"text-center py-12 text-neutral-500\">\r\n                                    <History className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\r\n                                    <p>Nenhum agendamento conclu√≠do ou cancelado neste m√™s</p>\r\n                                </div>\r\n                            ) : (\r\n                                historyAppointments.map(apt => {\r\n                                    const professional = teamMembers.find(m => m.id === apt.professional_id);\r\n                                    const { hasDiscount, discountPercentage, isCustomPriceHigher } = getDiscountInfo(apt);\r\n\r\n                                    return (\r\n                                        <div\r\n                                            key={apt.id}\r\n                                            className={`border-2 rounded-lg p-4 ${apt.status === 'Completed'\r\n                                                ? 'bg-green-500/10 border-green-500'\r\n                                                : 'bg-red-500/10 border-red-500'\r\n                                                }`}\r\n                                        >\r\n                                            <div className=\"flex items-start justify-between\">\r\n                                                <div className=\"flex-1\">\r\n                                                    <div className=\"flex items-center gap-2 mb-2\">\r\n                                                        <span className={`text-xs font-mono font-bold px-2 py-1 rounded ${apt.status === 'Completed'\r\n                                                            ? 'bg-green-500 text-black'\r\n                                                            : 'bg-red-500 text-white'\r\n                                                            }`}>\r\n                                                            {apt.status === 'Completed' ? '‚úì CONCLU√çDO' : '‚úó CANCELADO'}\r\n                                                        </span>\r\n                                                        <span className=\"text-neutral-400 text-xs\">\r\n                                                            {new Date(apt.appointment_time).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })} √†s {new Date(apt.appointment_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p className=\"text-white font-bold text-base mb-1\">{apt.clientName}</p>\r\n                                                    <p className=\"text-neutral-400 text-sm mb-1\">{apt.service}</p>\r\n                                                    {professional && (\r\n                                                        <p className=\"text-neutral-500 text-xs\">\r\n                                                            Profissional: {professional.name}\r\n                                                        </p>\r\n                                                    )}\r\n                                                    <button\r\n                                                        onClick={() => setShowingDetailsAppointment(apt)}\r\n                                                        className=\"text-neutral-500 hover:text-white transition-colors mt-1 flex items-center gap-1 text-xs\"\r\n                                                        title=\"Ver detalhes\"\r\n                                                    >\r\n                                                        <Info className=\"w-3 h-3\" />\r\n                                                        Detalhes\r\n                                                    </button>\r\n                                                </div>\r\n                                                <div className=\"text-right flex flex-col items-end gap-2\">\r\n                                                    {hasDiscount && apt.basePrice && (\r\n                                                        <span className=\"text-xs font-mono text-red-500 line-through\">\r\n                                                            {formatCurrency(apt.basePrice, currencyRegion)}\r\n                                                        </span>\r\n                                                    )}\r\n                                                    <p className={`text-lg font-mono font-bold ${accentText}`}>\r\n                                                        {formatCurrency(apt.price, currencyRegion)}\r\n                                                    </p>\r\n                                                    {hasDiscount && (\r\n                                                        <span className=\"text-[10px] font-bold px-2 py-0.5 rounded bg-red-500/20 text-red-400 flex items-center gap-1\">\r\n                                                            {discountPercentage}% OFF\r\n                                                        </span>\r\n                                                    )}\r\n                                                    {isCustomPriceHigher && (\r\n                                                        <span className=\"text-[10px] font-bold px-2 py-0.5 rounded bg-blue-500/20 text-blue-400 flex items-center gap-1\">\r\n                                                            Pre√ßo Customizado\r\n                                                        </span>\r\n                                                    )}\r\n                                                    <button\r\n                                                        onClick={() => handleDeleteHistoryAppointment(apt.id)}\r\n                                                        className=\"p-2 text-red-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\"\r\n                                                        title=\"Excluir agendamento\"\r\n                                                    >\r\n                                                        <Trash2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"mt-6 pt-4 border-t border-neutral-800\">\r\n                            <BrutalButton\r\n                                variant=\"secondary\"\r\n                                className=\"w-full\"\r\n                                onClick={() => setShowHistoryModal(false)}\r\n                            >\r\n                                Fechar\r\n                            </BrutalButton>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* New Appointment Wizard */}\r\n            {showNewAppointmentModal && (\r\n                <AppointmentWizard\r\n                    onClose={() => {\r\n                        setShowNewAppointmentModal(false);\r\n                        navigate(location.pathname, { replace: true });\r\n                    }}\r\n                    onSuccess={(date) => {\r\n                        const newDateStr = date.toISOString().split('T')[0];\r\n                        navigate(`/agenda?date=${newDateStr}`, { replace: true });\r\n                        fetchData(); // Refresh data\r\n                        setShowNewAppointmentModal(false);\r\n                    }}\r\n                    initialDate={selectedDate}\r\n                    teamMembers={teamMembers}\r\n                    services={services}\r\n                    categories={categories}\r\n                    clients={clients}\r\n                    onRefreshClients={fetchClients}\r\n                />\r\n            )}\r\n\r\n            {/* Edit Appointment Modal */}\r\n            {editingAppointment && (\r\n                <AppointmentEditModal\r\n                    appointment={editingAppointment}\r\n                    teamMembers={teamMembers}\r\n                    services={services}\r\n                    clients={clients}\r\n                    onClose={() => setEditingAppointment(null)}\r\n                    onSave={fetchData}\r\n                    accentColor={accentColor}\r\n                    currencySymbol={currencySymbol}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\ClientCRM.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Clients.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":104,"column":21,"nodeType":"MemberExpression","messageId":"unexpected","endLine":104,"endColumn":32,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4104,4173],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":119,"column":25,"nodeType":"MemberExpression","messageId":"unexpected","endLine":119,"endColumn":36,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4969,5024],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\nimport { BrutalCard } from '../components/BrutalCard';\r\nimport { BrutalButton } from '../components/BrutalButton';\r\nimport { PhoneInput } from '../components/PhoneInput';\r\nimport { Plus, Search, User, Star, ChevronRight, MessageCircle } from 'lucide-react';\r\nimport { Link, useSearchParams } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { formatPhone } from '../utils/formatters';\r\n\r\nexport const Clients: React.FC = () => {\r\n    const { user, userType, region } = useAuth();\r\n    const [searchParams] = useSearchParams();\r\n    const [clients, setClients] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState(searchParams.get('search') || '');\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    // Form State\r\n    const [name, setName] = useState('');\r\n    const [email, setEmail] = useState('');\r\n    const [phone, setPhone] = useState('');\r\n    const [photo, setPhoto] = useState<File | null>(null);\r\n    const [uploading, setUploading] = useState(false);\r\n\r\n    const isBeauty = userType === 'beauty';\r\n    const buttonClass = isBeauty ? 'bg-beauty-neon hover:bg-beauty-neonHover text-black' : 'bg-accent-gold hover:bg-accent-goldHover text-black';\r\n\r\n    const fetchClients = async () => {\r\n        try {\r\n            // Fetch clients, filtering out inactive ones\r\n            const { data, error } = await supabase\r\n                .from('clients')\r\n                .select('*')\r\n                .eq('user_id', user.id)\r\n                .neq('is_active', false) // Filter out inactive clients (soft deleted)\r\n                .order('name', { ascending: true });\r\n\r\n            if (error) throw error;\r\n\r\n            if (data) {\r\n                // Fetch actual visit counts from completed appointments for all clients\r\n                const clientIds = data.map(c => c.id);\r\n\r\n                const { data: appointmentCounts, error: countError } = await supabase\r\n                    .from('appointments')\r\n                    .select('client_id')\r\n                    .in('client_id', clientIds)\r\n                    .eq('status', 'Completed')\r\n                    .eq('user_id', user.id);\r\n\r\n                if (!countError && appointmentCounts) {\r\n                    // Count visits per client\r\n                    const visitCounts: Record<string, number> = {};\r\n                    appointmentCounts.forEach(apt => {\r\n                        visitCounts[apt.client_id] = (visitCounts[apt.client_id] || 0) + 1;\r\n                    });\r\n\r\n                    // Merge visit counts into client data\r\n                    const clientsWithVisits = data.map(client => ({\r\n                        ...client,\r\n                        actual_visits: visitCounts[client.id] || 0\r\n                    }));\r\n\r\n                    setClients(clientsWithVisits);\r\n                } else {\r\n                    setClients(data);\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching clients:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchClients();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const querySearch = searchParams.get('search');\r\n        if (querySearch) {\r\n            setSearchTerm(querySearch);\r\n        }\r\n    }, [searchParams]);\r\n\r\n    const handleCreateClient = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setUploading(true);\r\n        try {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) throw new Error('Usu√°rio n√£o autenticado');\r\n\r\n            let photoUrl = null;\r\n\r\n            // Upload photo if provided - make this optional and non-blocking\r\n            if (photo) {\r\n                try {\r\n                    const fileExt = photo.name.split('.').pop();\r\n                    const fileName = `${user.id}/${Date.now()}.${fileExt}`;\r\n\r\n                    console.log('Attempting to upload photo to client_photos bucket...');\r\n\r\n                    const { data: uploadData, error: uploadError } = await supabase.storage\r\n                        .from('client_photos')\r\n                        .upload(fileName, photo);\r\n\r\n                    if (uploadError) {\r\n                        console.error('Photo upload error:', uploadError);\r\n                        // Don't throw - just warn the user and continue without photo\r\n                        alert('Aviso: N√£o foi poss√≠vel fazer upload da foto. O cliente ser√° criado sem foto.');\r\n                    } else {\r\n                        const { data: { publicUrl } } = supabase.storage\r\n                            .from('client_photos')\r\n                            .getPublicUrl(fileName);\r\n                        photoUrl = publicUrl;\r\n                        console.log('Photo uploaded successfully:', publicUrl);\r\n                    }\r\n                } catch (photoError) {\r\n                    console.error('Photo upload exception:', photoError);\r\n                    alert('Aviso: Erro ao fazer upload da foto. O cliente ser√° criado sem foto.');\r\n                }\r\n            }\r\n\r\n            // Create client regardless of photo upload success\r\n            const { error } = await supabase.from('clients').insert({\r\n                user_id: user.id,\r\n                name,\r\n                email,\r\n                phone,\r\n                photo_url: photoUrl,\r\n                loyalty_tier: 'Bronze',\r\n                total_visits: 0,\r\n                rating: 0\r\n            });\r\n\r\n            if (error) throw error;\r\n\r\n            alert('Cliente criado com sucesso!');\r\n            setShowModal(false);\r\n            fetchClients();\r\n            setName('');\r\n            setEmail('');\r\n            setPhone('');\r\n            setPhoto(null);\r\n        } catch (error: any) {\r\n            console.error('Error creating client:', error);\r\n            alert(`Erro ao criar cliente: ${error.message || JSON.stringify(error)}`);\r\n        } finally {\r\n            setUploading(false);\r\n        }\r\n    };\r\n\r\n    const filteredClients = clients.filter(client => {\r\n        const matchesSearch = client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n            client.phone?.includes(searchTerm);\r\n        return matchesSearch;\r\n    });\r\n\r\n    return (\r\n        <div className=\"space-y-6 relative\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center border-b-4 border-white/10 pb-4 gap-4\">\r\n                <h2 className=\"text-2xl md:text-4xl font-heading text-white uppercase\">Clientes</h2>\r\n                <BrutalButton variant=\"primary\" icon={<Plus />} onClick={() => setShowModal(true)} className=\"w-full md:w-auto\">Novo Cliente</BrutalButton>\r\n            </div>\r\n\r\n\r\n\r\n            {/* Search Bar */}\r\n            <div className=\"relative\">\r\n                <Search className={`absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 ${isBeauty ? 'text-beauty-neon/50' : 'text-neutral-500'}`} />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Buscar por nome ou telefone...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className={`\r\n                        w-full p-4 pl-12 text-white font-mono text-sm outline-none transition-all duration-300\r\n                        ${isBeauty\r\n                            ? 'bg-beauty-card/50 border border-beauty-neon/20 rounded-xl focus:border-beauty-neon focus:shadow-neon'\r\n                            : 'bg-black/40 border-2 border-neutral-800 focus:border-accent-gold focus:shadow-heavy-sm'\r\n                        }\r\n                    `}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                {loading ? (\r\n                    <div className=\"col-span-full text-center text-text-secondary p-10\">Carregando clientes...</div>\r\n                ) : filteredClients.length === 0 ? (\r\n                    <div className=\"col-span-full text-center text-text-secondary p-10\">Nenhum cliente encontrado.</div>\r\n                ) : (\r\n                    filteredClients.map(client => {\r\n                        const rating = client.rating || 0;\r\n                        // Use actual_visits from our query, fallback to total_visits column\r\n                        const totalVisits = client.actual_visits ?? client.total_visits ?? 0;\r\n\r\n                        return (\r\n                            <Link key={client.id} to={`/clientes/${client.id}`}>\r\n                                <BrutalCard className=\"hover:border-white/40 transition-colors cursor-pointer group h-full relative\">\r\n                                    <div className=\"flex items-start justify-between mb-4\">\r\n                                        <div className={`w-12 h-12 rounded-full border-2 ${isBeauty ? 'border-beauty-neon' : 'border-accent-gold'} flex items-center justify-center bg-black overflow-hidden`}>\r\n                                            {client.photo_url ? (\r\n                                                <img src={client.photo_url} alt={client.name} className=\"w-full h-full object-cover\" />\r\n                                            ) : (\r\n                                                <User className={isBeauty ? 'text-beauty-neon' : 'text-accent-gold'} />\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"flex flex-col items-end gap-1\">\r\n                                            <span className=\"text-xs font-mono text-neutral-400\">\r\n                                                {totalVisits} visita{totalVisits !== 1 ? 's' : ''}\r\n                                            </span>\r\n                                            {rating > 0 && (\r\n                                                <div className=\"flex gap-0.5\">\r\n                                                    {[1, 2, 3, 4, 5].map(i => (\r\n                                                        <Star\r\n                                                            key={i}\r\n                                                            className={`w-3 h-3 ${i <= rating ? 'fill-accent-gold text-accent-gold' : 'text-neutral-600'}`}\r\n                                                        />\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center justify-between\">\r\n                                        <div>\r\n                                            <h3 className={`text-lg font-heading text-white mb-1 group-hover:${isBeauty ? 'text-beauty-neon' : 'text-accent-gold'} transition-colors`}>{client.name}</h3>\r\n                                            <p className=\"text-sm text-text-secondary font-mono flex items-center gap-2\">\r\n                                                {client.phone ? formatPhone(client.phone, region as any) : 'Sem telefone'}\r\n                                                {client.phone && (\r\n                                                    <button\r\n                                                        onClick={(e) => {\r\n                                                            e.preventDefault();\r\n                                                            e.stopPropagation();\r\n                                                            window.open(`https://wa.me/${client.phone.replace(/\\D/g, '')}`, '_blank');\r\n                                                        }}\r\n                                                        className={`p-1 rounded-full hover:bg-green-500/10 transition-colors ${isBeauty ? 'text-green-400 hover:text-green-300' : 'text-green-600 hover:text-green-500'}`}\r\n                                                        title=\"WhatsApp\"\r\n                                                    >\r\n                                                        <MessageCircle className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                )}\r\n                                            </p>\r\n                                        </div>\r\n                                        {/* Clickable Indicator */}\r\n                                        <ChevronRight className={`w-5 h-5 text-neutral-600 group-hover:${isBeauty ? 'text-beauty-neon' : 'text-accent-gold'} group-hover:translate-x-1 transition-all`} />\r\n                                    </div>\r\n                                </BrutalCard>\r\n                            </Link>\r\n                        );\r\n                    })\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal */}\r\n            {showModal && (\r\n                <div className={`fixed inset-0 z-50 flex items-center justify-center p-4 ${isBeauty ? 'bg-beauty-dark/80' : 'bg-black/85'}`}>\r\n                    <div className={`\r\n                        w-full max-w-md p-6 relative modal-enter\r\n                        ${isBeauty\r\n                            ? 'bg-gradient-to-br from-beauty-card to-beauty-dark border border-beauty-neon/30 rounded-2xl shadow-[0_0_20px_rgba(167,139,250,0.15)]'\r\n                            : 'bg-brutal-card border-4 border-brutal-border shadow-heavy-lg'\r\n                        }\r\n                    `}>\r\n                        <button\r\n                            onClick={() => setShowModal(false)}\r\n                            className={`absolute top-4 right-4 p-1.5 rounded-full transition-all ${isBeauty ? 'text-beauty-neon/60 hover:text-beauty-neon hover:bg-beauty-neon/10' : 'text-neutral-500 hover:text-white hover:bg-neutral-800'}`}\r\n                        >\r\n                            <span className=\"text-xl font-bold\">√ó</span>\r\n                        </button>\r\n                        <h3 className={`text-xl font-heading text-white mb-6 ${isBeauty ? '' : 'uppercase'}`}>Novo Cliente</h3>\r\n\r\n                        <form onSubmit={handleCreateClient} className=\"space-y-4\">\r\n                            <div>\r\n                                <label className={`block text-xs font-mono mb-2 ${isBeauty ? 'text-beauty-neon/70' : 'text-neutral-500'}`}>Nome Completo</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={name}\r\n                                    onChange={(e) => setName(e.target.value)}\r\n                                    className={`\r\n                                        w-full p-3 text-white outline-none transition-all duration-300\r\n                                        ${isBeauty\r\n                                            ? 'bg-beauty-dark/50 border border-beauty-neon/20 rounded-xl focus:border-beauty-neon focus:shadow-[0_0_10px_rgba(167,139,250,0.2)]'\r\n                                            : 'bg-black border-2 border-neutral-700 focus:border-accent-gold'\r\n                                        }\r\n                                    `}\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className={`block text-xs font-mono mb-2 ${isBeauty ? 'text-beauty-neon/70' : 'text-neutral-500'}`}>Telefone</label>\r\n                                <PhoneInput\r\n                                    value={phone}\r\n                                    onChange={setPhone}\r\n                                    defaultRegion={region as 'BR' | 'PT'}\r\n                                    className=\"w-full\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className={`block text-xs font-mono mb-2 ${isBeauty ? 'text-beauty-neon/70' : 'text-neutral-500'}`}>Email (Opcional)</label>\r\n                                <input\r\n                                    type=\"email\"\r\n                                    value={email}\r\n                                    onChange={(e) => setEmail(e.target.value)}\r\n                                    className={`\r\n                                        w-full p-3 text-white outline-none transition-all duration-300\r\n                                        ${isBeauty\r\n                                            ? 'bg-beauty-dark/50 border border-beauty-neon/20 rounded-xl focus:border-beauty-neon focus:shadow-[0_0_10px_rgba(167,139,250,0.2)]'\r\n                                            : 'bg-black border-2 border-neutral-700 focus:border-accent-gold'\r\n                                        }\r\n                                    `}\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className={`block text-xs font-mono mb-2 ${isBeauty ? 'text-beauty-neon/70' : 'text-neutral-500'}`}>Foto (Opcional)</label>\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\"image/*\"\r\n                                    onChange={(e) => setPhoto(e.target.files?.[0] || null)}\r\n                                    className={`\r\n                                        w-full p-3 text-white outline-none transition-all duration-300\r\n                                        ${isBeauty\r\n                                            ? 'bg-beauty-dark/50 border border-beauty-neon/20 rounded-xl file:mr-4 file:py-2 file:px-4 file:border-0 file:rounded-lg file:text-sm file:font-semibold file:bg-beauty-neon file:text-black hover:file:bg-beauty-neonHover'\r\n                                            : 'bg-black border-2 border-neutral-700 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-accent-gold file:text-black hover:file:bg-accent-goldHover'\r\n                                        }\r\n                                    `}\r\n                                />\r\n                                <p className=\"text-xs text-neutral-500 mt-1\">Formatos aceitos: JPG, PNG</p>\r\n                            </div>\r\n\r\n                            <BrutalButton\r\n                                type=\"submit\"\r\n                                variant=\"primary\"\r\n                                fullWidth\r\n                                loading={uploading}\r\n                                className=\"mt-4\"\r\n                            >\r\n                                {uploading ? 'Cadastrando...' : 'Cadastrar'}\r\n                            </BrutalButton>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Dashboard.tsx","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":101,"column":40,"nodeType":"MemberExpression","messageId":"unexpected","endLine":101,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { BrutalCard } from '../components/BrutalCard';\r\nimport { BrutalButton } from '../components/BrutalButton';\r\nimport { Clock, AlertTriangle, ArrowRight } from 'lucide-react';\r\nimport { ProfitMetrics } from '../components/dashboard/ProfitMetrics';\r\nimport { ActionCenter } from '../components/dashboard/ActionCenter';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useAlerts } from '../contexts/AlertsContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { InfoButton, AIAssistantButton } from '../components/HelpButtons';\r\nimport { GoalHistory } from '../components/GoalHistory';\r\n\r\nimport { formatCurrency } from '../utils/formatters';\r\nimport { useAppTour } from '../hooks/useAppTour';\r\nimport { useDashboardData } from '../hooks/useDashboardData';\r\n\r\nexport const Dashboard: React.FC = () => {\r\n  const { userType, region } = useAuth();\r\n  const { alerts } = useAlerts();\r\n  const navigate = useNavigate();\r\n  const { startTour } = useAppTour();\r\n\r\n  const {\r\n    appointments,\r\n    loading,\r\n    monthlyGoal,\r\n    goalHistory,\r\n    updateGoal,\r\n    profitMetrics,\r\n    actionItems\r\n  } = useDashboardData();\r\n\r\n  const [isEditingGoal, setIsEditingGoal] = useState(false);\r\n  const [newGoal, setNewGoal] = useState(monthlyGoal.toString());\r\n\r\n  const isBeauty = userType === 'beauty';\r\n  const currencyRegion = region === 'PT' ? 'PT' : 'BR';\r\n  const currencySymbol = region === 'PT' ? '‚Ç¨' : 'R$';\r\n  const accentText = isBeauty ? 'text-beauty-neon' : 'text-accent-gold';\r\n\r\n  const handleSaveGoal = async () => {\r\n    const goalValue = parseFloat(newGoal);\r\n    if (isNaN(goalValue)) return;\r\n\r\n    const { error } = await updateGoal(goalValue);\r\n\r\n    if (error) {\r\n      console.error(\"Error updating goal:\", error);\r\n      alert(\"Erro ao atualizar a meta.\");\r\n    } else {\r\n      setIsEditingGoal(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4 md:space-y-8\">\r\n      <div className=\"flex flex-col md:flex-row justify-between items-start md:items-end border-b-2 md:border-b-4 border-white/10 pb-4 md:pb-6 gap-3 md:gap-4 animate-in fade-in slide-in-from-top-4 duration-500\">\r\n        <div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <h2 className=\"text-sm md:text-xl font-heading text-text-secondary uppercase tracking-widest\">Painel de Controle</h2>\r\n            <AIAssistantButton context=\"o painel geral e suas m√©tricas de lucro\" />\r\n          </div>\r\n          <h1 className=\"text-2xl md:text-5xl font-heading text-white mt-1\">\r\n            Vis√£o Geral de <span className={accentText}>Lucro</span>\r\n          </h1>\r\n        </div>\r\n        <div className=\"flex gap-2 w-full md:w-auto\">\r\n          <button\r\n            onClick={startTour}\r\n            className=\"p-2 md:p-3 rounded-lg border border-neutral-800 hover:bg-white/5 text-neutral-400 hover:text-white transition-colors\"\r\n            title=\"Iniciar Tour Guiado\"\r\n          >\r\n            <InfoButton text=\"Tutorial\" />\r\n          </button>\r\n          <BrutalButton\r\n            id=\"dashboard-new-appointment\"\r\n            variant=\"primary\"\r\n            size=\"md\"\r\n            icon={<Clock />}\r\n            className=\"w-full md:w-auto flex-1 text-sm md:text-base h-11 md:h-auto\"\r\n            onClick={() => navigate('/agenda')}\r\n          >\r\n            Novo Agendamento\r\n          </BrutalButton>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-500 delay-150\">\r\n        <ProfitMetrics\r\n          metrics={profitMetrics}\r\n          currencySymbol={currencySymbol}\r\n          currencyRegion={currencyRegion}\r\n          isBeauty={isBeauty}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-300\">\r\n        <div className=\"lg:col-span-1 h-full\">\r\n          <ActionCenter\r\n            actions={actionItems}\r\n            onActionClick={(action) => console.log('Action clicked:', action)}\r\n            isBeauty={isBeauty}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"lg:col-span-2 space-y-4 md:space-y-6\">\r\n          <BrutalCard\r\n            id=\"dashboard-appointments-list\"\r\n            title={\r\n              <div className=\"flex items-center gap-2\">\r\n                <span>Pr√≥ximos Atendimentos</span>\r\n                <InfoButton text=\"Seus pr√≥ximos compromissos para hoje.\" />\r\n              </div>\r\n            }\r\n            className=\"brutal-card-enhanced\"\r\n            noPadding\r\n          >\r\n            {loading ? (\r\n              <div className=\"p-4 text-center text-text-secondary\">Carregando agendamentos...</div>\r\n            ) : (\r\n              <ul className=\"divide-y-2 divide-neutral-800\">\r\n                {appointments.map((apt) => (\r\n                  <li\r\n                    key={apt.id}\r\n                    className=\"p-3 md:p-4 hover:bg-white/5 transition-colors flex items-center justify-between group cursor-pointer\"\r\n                    onClick={() => navigate(`/agenda?date=${apt.rawDate}`)}\r\n                  >\r\n                    <div className=\"flex items-center gap-3 md:gap-4\">\r\n                      <div className={`font-mono text-base md:text-xl font-bold ${accentText} bg-neutral-900 px-2 py-1 md:px-3 md:py-2 border border-neutral-700 flex flex-col items-center min-w-[70px]`}>\r\n                        <span>{apt.time}</span>\r\n                        <span className=\"text-[10px] md:text-xs opacity-70 mt-1\">\r\n                          {new Date(apt.appointment_time).toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' })}\r\n                        </span>\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"font-heading text-sm md:text-lg text-white\">{apt.clientName}</p>\r\n                        <p className=\"text-[10px] md:text-sm text-text-secondary font-mono\">{apt.service}</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"opacity-100 lg:opacity-0 lg:group-hover:opacity-100 transition-opacity\">\r\n                      <BrutalButton size=\"sm\" variant=\"ghost\">Ver</BrutalButton>\r\n                    </div>\r\n                  </li>\r\n                ))}\r\n                {appointments.length === 0 && (\r\n                  <li className=\"p-4 text-center text-text-secondary\">Nenhum agendamento encontrado.</li>\r\n                )}\r\n              </ul>\r\n            )}\r\n            <div className=\"p-3 border-t-2 border-dashed border-neutral-700\">\r\n              <button\r\n                onClick={() => navigate('/agenda')}\r\n                className={`w-full py-1 text-center text-xs font-mono text-text-secondary hover:${accentText} uppercase tracking-widest transition-colors`}\r\n              >\r\n                Ver Agenda Completa ‚Üí\r\n              </button>\r\n            </div>\r\n          </BrutalCard>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <BrutalCard className=\"h-full brutal-card-enhanced gold-accent-border\" noPadding>\r\n              <div className=\"p-4\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-xs font-bold uppercase text-text-secondary\">Meta Mensal</span>\r\n                  </div>\r\n                  <span className={`text-sm font-mono font-bold ${accentText}`}>{formatCurrency(monthlyGoal, currencyRegion)}</span>\r\n                </div>\r\n                <div className=\"w-full bg-neutral-800 h-2 rounded-full overflow-hidden mt-2\">\r\n                  <div className={`h-full ${isBeauty ? 'bg-beauty-neon' : 'bg-accent-gold'}`} style={{ width: '65%' }}></div>\r\n                </div>\r\n                <p className=\"text-[10px] text-text-secondary mt-2 text-right\">65% atingido</p>\r\n              </div>\r\n            </BrutalCard>\r\n\r\n            <BrutalCard className=\"h-full brutal-card-enhanced\" noPadding>\r\n              <div className=\"p-4\">\r\n                <div className=\"flex items-center gap-2 mb-3\">\r\n                  <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />\r\n                  <span className=\"text-xs font-bold uppercase text-white\">Avisos do Sistema</span>\r\n                </div>\r\n                {alerts.length > 0 ? (\r\n                  <div className=\"space-y-2\">\r\n                    {alerts.slice(0, 2).map(alert => (\r\n                      <div key={alert.id} className=\"text-xs text-text-secondary border-l-2 border-yellow-500 pl-2\">\r\n                        {alert.text}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <p className=\"text-xs text-text-secondary\">Tudo operando normalmente.</p>\r\n                )}\r\n              </div>\r\n            </BrutalCard>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Finance.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\ForgotPassword.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Login.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Marketing.tsx","messages":[{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Plus' is not defined.","line":53,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":53,"endColumn":32}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { BrutalCard } from '../components/BrutalCard';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport {\r\n    Megaphone, Sparkles, Calendar, Target,\r\n    MessageSquare, ImageIcon, Wand2, Clock, Bell, Info\r\n} from 'lucide-react';\r\nimport { BrutalButton } from '../components/BrutalButton';\r\n\r\nexport const Marketing: React.FC = () => {\r\n    const { userType } = useAuth();\r\n\r\n    const isBeauty = userType === 'beauty';\r\n    const accentColor = isBeauty ? 'beauty-neon' : 'accent-gold';\r\n    const accentText = isBeauty ? 'text-beauty-neon' : 'text-accent-gold';\r\n    const accentBg = isBeauty ? 'bg-beauty-neon' : 'bg-accent-gold';\r\n\r\n    const upcomingFeatures = [\r\n        {\r\n            icon: Megaphone,\r\n            title: 'Campanhas Automatizadas',\r\n            description: 'Dispare mensagens de WhatsApp, SMS e E-mail para seus clientes de forma segmentada.'\r\n        },\r\n        {\r\n            icon: Sparkles,\r\n            title: 'Editor de Fotos IA',\r\n            description: 'Melhore suas fotos de cortes e servi√ßos automaticamente com intelig√™ncia artificial.'\r\n        },\r\n        {\r\n            icon: Calendar,\r\n            title: 'Calend√°rio de Conte√∫do',\r\n            description: 'Receba sugest√µes di√°rias do que postar nas suas redes sociais para atrair mais clientes.'\r\n        },\r\n        {\r\n            icon: Target,\r\n            title: 'Intelig√™ncia de P√∫blico',\r\n            description: 'Identifique clientes que n√£o voltam h√° tempos e crie campanhas de reativa√ß√£o autom√°ticas.'\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"space-y-6 md:space-y-8 pb-20\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 border-b-4 border-white/10 pb-4\">\r\n                <div>\r\n                    <h2 className=\"text-2xl md:text-4xl font-heading text-white uppercase\">Marketing Inteligente</h2>\r\n                    <p className=\"text-text-secondary font-mono mt-1 md:mt-2 text-sm md:text-base\">\r\n                        Atraia e fidelize mais clientes usando o poder da IA\r\n                    </p>\r\n                </div>\r\n                <BrutalButton\r\n                    variant=\"primary\"\r\n                    icon={<Plus />}\r\n                    onClick={() => alert('O Criador de Campanhas com IA est√° em fase final de desenvolvimento e ser√° liberado em breve!')}\r\n                    id=\"create-campaign-btn\"\r\n                >\r\n                    Criar Campanha\r\n                </BrutalButton>\r\n            </div>\r\n\r\n            {/* Coming Soon Banner */}\r\n            <BrutalCard className={`border-l-4 border-${accentColor} bg-gradient-to-r from-neutral-900 to-neutral-800`}>\r\n                <div className=\"flex flex-col md:flex-row items-center gap-6 py-8\">\r\n                    <div className={`p-6 rounded-full ${accentBg}/10`}>\r\n                        <MessageSquare className={`w-16 h-16 ${accentText}`} />\r\n                    </div>\r\n                    <div className=\"text-center md:text-left flex-1\">\r\n                        <h3 className={`text-3xl font-heading ${accentText} uppercase mb-2`}>\r\n                            Em Breve!\r\n                        </h3>\r\n                        <p className=\"text-white text-lg mb-4\">\r\n                            Sua barbearia/sal√£o ter√° um departamento de marketing completo integrado ao sistema.\r\n                        </p>\r\n                        <p className=\"text-neutral-400 text-sm\">\r\n                            Estamos finalizando as integra√ß√µes de IA para que voc√™ possa criar an√∫ncios, editar fotos\r\n                            e enviar mensagens autom√°ticas sem esfor√ßo.\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </BrutalCard>\r\n\r\n            {/* Upcoming Features */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {upcomingFeatures.map((feature, index) => (\r\n                    <BrutalCard key={index} className=\"opacity-60 hover:opacity-80 transition-opacity\">\r\n                        <div className=\"flex items-start gap-4\">\r\n                            <div className=\"p-3 bg-neutral-800 rounded-lg\">\r\n                                <feature.icon className=\"w-6 h-6 text-neutral-400\" />\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"text-white font-bold text-lg mb-1\">{feature.title}</h4>\r\n                                <p className=\"text-neutral-500 text-sm\">{feature.description}</p>\r\n                            </div>\r\n                        </div>\r\n                    </BrutalCard>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Notify Me */}\r\n            <BrutalCard className=\"text-center\">\r\n                <Bell className=\"w-12 h-12 text-neutral-600 mx-auto mb-4\" />\r\n                <h4 className=\"text-white font-heading text-xl uppercase mb-2\">\r\n                    Quer turbinar seu marketing?\r\n                </h4>\r\n                <p className=\"text-neutral-400 text-sm mb-6 max-w-md mx-auto\">\r\n                    Avisaremos assim que as ferramentas de IA estiverem prontas para impulsionar seu faturamento.\r\n                </p>\r\n                <BrutalButton variant=\"secondary\" disabled>\r\n                    <span className=\"flex items-center gap-2\">\r\n                        <Sparkles className=\"w-4 h-4\" />\r\n                        Em Desenvolvimento\r\n                    </span>\r\n                </BrutalButton>\r\n            </BrutalCard>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\OnboardingWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Placeholder.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\ProfessionalPortfolio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\PublicBooking.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\QueueJoin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\QueueManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\QueueStatus.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Register.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\Reports.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\UpdatePassword.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\AuditLogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\CommissionsSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\GeneralSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\PublicBookingSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\RecycleBin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\SecuritySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\ServiceSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\SubscriptionSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\SystemLogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\pages\\settings\\TeamSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\scripts\\verify_rls.ts","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":24,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":24,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[737,794],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":27,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":27,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[883,945],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":34,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":34,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1190,1270],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1462,1534],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":45,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":45,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1698,1741],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":51,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":51,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2039,2121],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":53,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":53,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2145,2204],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":57,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":57,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2425,2506],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":61,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":61,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2532,2567],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport * as dotenv from 'dotenv';\r\nimport { fileURLToPath } from 'url';\r\nimport { dirname, resolve } from 'path';\r\n\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = dirname(__filename);\r\n\r\ndotenv.config({ path: resolve(__dirname, '../.env.local') });\r\n\r\nconst supabaseUrl = process.env.VITE_SUPABASE_URL || '';\r\nconst supabaseAnonKey = process.env.VITE_SUPABASE_ANON_KEY || '';\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n    console.error('Missing Supabase credentials in .env.local');\r\n    process.exit(1);\r\n}\r\n\r\n// Create a client with the anon key\r\nconst supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\nasync function runSecurityCheck() {\r\n    console.log('üîí Starting Security Verification Scan...');\r\n\r\n    // 1. Check Public Access to Protected Tables (Should fail or return empty)\r\n    console.log('\\n1Ô∏è‚É£  Testing Public Access (Unauthenticated)');\r\n    const protectedTables = ['appointments', 'clients', 'financial_records'];\r\n\r\n    for (const table of protectedTables) {\r\n        const { data, error } = await supabase.from(table).select('*').limit(5);\r\n\r\n        if (error) {\r\n            console.log(`‚úÖ [${table}] Access denied or error: ${error.message} (Expected)`);\r\n        } else if (data && data.length > 0) {\r\n            console.error(`‚ùå [${table}] Public access ALLOWED! Found ${data.length} records. (CRITICAL FAIL)`);\r\n        } else {\r\n            console.log(`‚úÖ [${table}] No data returned (Expected for RLS enabled)`);\r\n        }\r\n    }\r\n\r\n    // 2. Check RLS Policies Existence (Requires Service Role - skipping, inferring from behavior above)\r\n\r\n    // 3. RPC Security Check\r\n    console.log('\\n2Ô∏è‚É£  Testing RPC Security');\r\n    // Attempt to call get_dashboard_stats without a user context (should fail or return empty if properly secured)\r\n\r\n    const { data: rpcData, error: rpcError } = await supabase.rpc('get_dashboard_stats', { p_user_id: '00000000-0000-0000-0000-000000000000' });\r\n\r\n    if (rpcError) {\r\n        console.log(`‚úÖ [get_dashboard_stats] Call failed or denied: ${rpcError.message}`);\r\n    } else {\r\n        console.log(`‚ÑπÔ∏è [get_dashboard_stats] Returned:`, rpcData);\r\n        if (rpcData && (rpcData.total_profit > 0 || rpcData.current_month_revenue > 0)) {\r\n            console.warn(`‚ö†Ô∏è [get_dashboard_stats] Returned data for dummy UUID. Check logic!`);\r\n        } else {\r\n            console.log(`‚úÖ [get_dashboard_stats] Returned empty/zero stats for dummy UUID.`);\r\n        }\r\n    }\r\n\r\n    console.log('\\nüèÅ Scan Complete.');\r\n}\r\n\r\nrunSecurityCheck();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\supabase\\functions\\create-checkout-session\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\supabase\\functions\\send-appointment-reminder\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\config.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\contexts\\AuthContext.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\hooks\\useDashboardData.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\lib\\gemini.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\utils\\date.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\test\\utils\\formatters.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\Logger.ts","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":19,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":19,"endColumn":25,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"info"},"fix":{"range":[447,496],"text":""},"desc":"Remove the console.info()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '../lib/supabase';\r\n\r\n// N√≠veis de Log\r\nexport type LogLevel = 'info' | 'warning' | 'error' | 'critical';\r\n\r\n// Interface para contexto extra\r\ninterface LogContext {\r\n    [key: string]: any;\r\n}\r\n\r\nclass LoggerService {\r\n    private isDevelopment = import.meta.env.DEV;\r\n\r\n    /**\r\n     * Loga mensagem informativa\r\n     */\r\n    info(message: string, context?: LogContext) {\r\n        if (this.isDevelopment) {\r\n            console.info(`[INFO] ${message}`, context || '');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Loga aviso (Warning)\r\n     */\r\n    warn(message: string, context?: LogContext) {\r\n        if (this.isDevelopment) {\r\n            console.warn(`[WARN] ${message}`, context || '');\r\n        }\r\n        // Opcional: Enviar warnings cr√≠ticos para o banco\r\n    }\r\n\r\n    /**\r\n     * Loga erro (Error) e envia para o backend\r\n     */\r\n    async error(message: string, error?: any, context?: LogContext) {\r\n        // 1. Console local\r\n        console.error(`[ERROR] ${message}`, error || '', context || '');\r\n\r\n        // 2. Enviar para Supabase (System Errors)\r\n        try {\r\n            const errorData = {\r\n                p_message: message,\r\n                p_stack: error?.stack || null,\r\n                p_component_stack: context?.componentStack || null,\r\n                p_severity: 'error',\r\n                p_context: {\r\n                    url: window.location.href,\r\n                    userAgent: navigator.userAgent,\r\n                    ...context,\r\n                    rawError: error?.toString()\r\n                }\r\n            };\r\n\r\n            // Fire and forget (n√£o aguardar para n√£o bloquear UI)\r\n            supabase.rpc('log_error', errorData).then(({ error: dbError }) => {\r\n                if (dbError) console.error('Falha ao enviar log para o banco:', dbError);\r\n            });\r\n\r\n        } catch (loggingError) {\r\n            console.error('Erro cr√≠tico no logger:', loggingError);\r\n        }\r\n\r\n        // 3. Integra√ß√£o Futura com Sentry\r\n        // if (Sentry) Sentry.captureException(error);\r\n    }\r\n\r\n    /**\r\n     * Loga erro cr√≠tico (Critical) - sistema inoperante\r\n     */\r\n    async critical(message: string, error?: any, context?: LogContext) {\r\n        console.error(`[CRITICAL] ${message}`, error || '', context || '');\r\n        await this.error(message, error, { ...context, severity: 'critical' });\r\n    }\r\n}\r\n\r\nexport const logger = new LoggerService();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\date.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\formatters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\passwordValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\tierSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\utils\\tokens.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\User\\Downloads\\Rhian-Lepore-main\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]